var StringView;(function(){"use strict";if(!Number.isInteger){Number.isInteger=function isInteger(nVal){return typeof nVal==="number"&&isFinite(nVal)&&nVal>-9007199254740992&&nVal<9007199254740992&&Math.floor(nVal)===nVal;};}
StringView=function(vInput,sEncoding,nOffset,nLength){var FTAView,aWhole,aRaw,fPutOutptCode,fGetOutptChrSize,nInptLen,nStartIdx=isFinite(nOffset)?nOffset:0,nTranscrType=15,vSource,nOutptLen,nCharStart,nCharEnd,nEndIdx,fGetInptChrSize,fGetInptChrCode,nOutptIdx,nInptIdx,nChrIdx,nChrCode,nIdx,nMapIdx;if(sEncoding){this.encoding=sEncoding.toString();}
encSwitch:switch(this.encoding){case"UTF-8":fPutOutptCode=StringView.putUTF8CharCode;fGetOutptChrSize=StringView.getUTF8CharLength;FTAView=Uint8Array;break encSwitch;case"UTF-16":fPutOutptCode=StringView.putUTF16CharCode;fGetOutptChrSize=StringView.getUTF16CharLength;FTAView=Uint16Array;break encSwitch;case"UTF-32":FTAView=Uint32Array;nTranscrType&=14;break encSwitch;default:FTAView=Uint8Array;nTranscrType&=14;}
typeSwitch:switch(typeof vInput){case"string":nTranscrType&=7;break typeSwitch;case"object":classSwitch:switch(vInput.constructor){case StringView:nTranscrType&=3;break typeSwitch;case String:nTranscrType&=7;break typeSwitch;case ArrayBuffer:aWhole=new FTAView(vInput);nInptLen=this.encoding==="UTF-32"?vInput.byteLength>>>2:this.encoding==="UTF-16"?vInput.byteLength>>>1:vInput.byteLength;aRaw=nStartIdx===0&&(!isFinite(nLength)||nLength===nInptLen)?aWhole:new FTAView(vInput,nStartIdx,!isFinite(nLength)?nInptLen-nStartIdx:nLength);break typeSwitch;case Uint32Array:case Uint16Array:case Uint8Array:FTAView=vInput.constructor;nInptLen=vInput.length;aWhole=vInput.byteOffset===0&&vInput.length===(FTAView===Uint32Array?vInput.buffer.byteLength>>>2:FTAView===Uint16Array?vInput.buffer.byteLength>>>1:vInput.buffer.byteLength)?vInput:new FTAView(vInput.buffer);aRaw=nStartIdx===0&&(!isFinite(nLength)||nLength===nInptLen)?vInput:vInput.subarray(nStartIdx,isFinite(nLength)?nStartIdx+nLength:nInptLen);break typeSwitch;default:aWhole=new FTAView(vInput);nInptLen=aWhole.length;aRaw=nStartIdx===0&&(!isFinite(nLength)||nLength===nInptLen)?aWhole:aWhole.subarray(nStartIdx,isFinite(nLength)?nStartIdx+nLength:nInptLen);}
break typeSwitch;default:aWhole=aRaw=new FTAView(Number(vInput)||0);}
if(nTranscrType<8){if(nTranscrType&4){vSource=vInput;nOutptLen=nInptLen=vSource.length;nTranscrType^=this.encoding==="UTF-32"?0:2;nStartIdx=nCharStart=nOffset?Math.max((nOutptLen+nOffset)%nOutptLen,0):0;nEndIdx=nCharEnd=(Number.isInteger(nLength)?Math.min(Math.max(nLength,0)+nStartIdx,nOutptLen):nOutptLen)-1;}else{vSource=vInput.rawData;nInptLen=vInput.makeIndex();nStartIdx=nCharStart=nOffset?Math.max((nInptLen+nOffset)%nInptLen,0):0;nOutptLen=Number.isInteger(nLength)?Math.min(Math.max(nLength,0),nInptLen-nCharStart):nInptLen;nEndIdx=nCharEnd=nOutptLen+nCharStart;if(vInput.encoding==="UTF-8"){fGetInptChrSize=StringView.getUTF8CharLength;fGetInptChrCode=StringView.loadUTF8CharCode;}else if(vInput.encoding==="UTF-16"){fGetInptChrSize=StringView.getUTF16CharLength;fGetInptChrCode=StringView.loadUTF16CharCode;}else{nTranscrType&=1;}}
if(nOutptLen===0||(nTranscrType<4&&vSource.encoding===this.encoding&&nCharStart===0&&nOutptLen===nInptLen)){nTranscrType=7;}
conversionSwitch:switch(nTranscrType){case 0:aWhole=new FTAView(nOutptLen);for(nOutptIdx=0;nOutptIdx<nOutptLen;nOutptIdx){aWhole[nOutptIdx]=vSource[nStartIdx+nOutptIdx++];}
break conversionSwitch;case 1:nOutptLen=0;for(nInptIdx=nStartIdx;nInptIdx<nEndIdx;nInptIdx++){nOutptLen+=fGetOutptChrSize(vSource[nInptIdx]);}
aWhole=new FTAView(nOutptLen);nOutptIdx=0;for(nInptIdx=nStartIdx;nOutptIdx<nOutptLen;nInptIdx++){nOutptIdx=fPutOutptCode(aWhole,vSource[nInptIdx],nOutptIdx);}
break conversionSwitch;case 2:nStartIdx=0;for(nChrIdx=0;nChrIdx<nCharStart;nChrIdx++){nChrCode=fGetInptChrCode(vSource,nStartIdx);nStartIdx+=fGetInptChrSize(nChrCode);}
aWhole=new FTAView(nOutptLen);for(nInptIdx=nStartIdx,nOutptIdx=0;nOutptIdx<nOutptLen;nInptIdx+=fGetInptChrSize(nChrCode),nOutptIdx++){nChrCode=fGetInptChrCode(vSource,nInptIdx);aWhole[nOutptIdx]=nChrCode;}
break conversionSwitch;case 3:nOutptLen=0;for(nChrIdx=0,nInptIdx=0;nChrIdx<nCharEnd;nInptIdx+=fGetInptChrSize(nChrCode)){nChrCode=fGetInptChrCode(vSource,nInptIdx);if(nChrIdx===nCharStart){nStartIdx=nInptIdx;}
if(++nChrIdx>nCharStart){nOutptLen+=fGetOutptChrSize(nChrCode);}}
aWhole=new FTAView(nOutptLen);nOutptIdx=0;for(nInptIdx=nStartIdx;nOutptIdx<nOutptLen;nInptIdx+=fGetInptChrSize(nChrCode)){nChrCode=fGetInptChrCode(vSource,nInptIdx);nOutptIdx=fPutOutptCode(aWhole,nChrCode,nOutptIdx);}
break conversionSwitch;case 4:aWhole=new FTAView(nOutptLen);for(nIdx=0;nIdx<nOutptLen;nIdx++){aWhole[nIdx]=vSource.charCodeAt(nIdx)&0xff;}
break conversionSwitch;case 5:nOutptLen=0;for(nMapIdx=0;nMapIdx<nInptLen;nMapIdx++){if(nMapIdx===nCharStart){nStartIdx=nOutptLen;}
nOutptLen+=fGetOutptChrSize(vSource.charCodeAt(nMapIdx));if(nMapIdx===nCharEnd){nEndIdx=nOutptLen;}}
aWhole=new FTAView(nOutptLen);for(nOutptIdx=0,nChrIdx=0;nOutptIdx<nOutptLen;nChrIdx++){nOutptIdx=fPutOutptCode(aWhole,vSource.charCodeAt(nChrIdx),nOutptIdx);}
break conversionSwitch;case 6:aWhole=new FTAView(nOutptLen);for(nIdx=0;nIdx<nOutptLen;nIdx++){aWhole[nIdx]=vSource.charCodeAt(nIdx);}
break conversionSwitch;case 7:aWhole=new FTAView(nOutptLen?vSource:0);break conversionSwitch;}
aRaw=nTranscrType>3&&(nStartIdx>0||nEndIdx<aWhole.length-1)?aWhole.subarray(nStartIdx,nEndIdx):aWhole;}
this.buffer=aWhole.buffer;this.bufferView=aWhole;this.rawData=aRaw;Object.freeze(this);}
StringView.loadUTF8CharCode=function(aChars,nIdx){var nLen=aChars.length,nPart=aChars[nIdx];return nPart>251&&nPart<254&&nIdx+5<nLen?(nPart-252)*1073741824+(aChars[nIdx+1]-128<<24)+(aChars[nIdx+2]-128<<18)+(aChars[nIdx+3]-128<<12)+(aChars[nIdx+4]-128<<6)+aChars[nIdx+5]-128:nPart>247&&nPart<252&&nIdx+4<nLen?(nPart-248<<24)+(aChars[nIdx+1]-128<<18)+(aChars[nIdx+2]-128<<12)+(aChars[nIdx+3]-128<<6)+aChars[nIdx+4]-128:nPart>239&&nPart<248&&nIdx+3<nLen?(nPart-240<<18)+(aChars[nIdx+1]-128<<12)+(aChars[nIdx+2]-128<<6)+aChars[nIdx+3]-128:nPart>223&&nPart<240&&nIdx+2<nLen?(nPart-224<<12)+(aChars[nIdx+1]-128<<6)+aChars[nIdx+2]-128:nPart>191&&nPart<224&&nIdx+1<nLen?(nPart-192<<6)+aChars[nIdx+1]-128:nPart;};StringView.putUTF8CharCode=function(aTarget,nChar,nPutAt){var nIdx=nPutAt;if(nChar<0x80){aTarget[nIdx++]=nChar;}else if(nChar<0x800){aTarget[nIdx++]=0xc0+(nChar>>>6);aTarget[nIdx++]=0x80+(nChar&0x3f);}else if(nChar<0x10000){aTarget[nIdx++]=0xe0+(nChar>>>12);aTarget[nIdx++]=0x80+((nChar>>>6)&0x3f);aTarget[nIdx++]=0x80+(nChar&0x3f);}else if(nChar<0x200000){aTarget[nIdx++]=0xf0+(nChar>>>18);aTarget[nIdx++]=0x80+((nChar>>>12)&0x3f);aTarget[nIdx++]=0x80+((nChar>>>6)&0x3f);aTarget[nIdx++]=0x80+(nChar&0x3f);}else if(nChar<0x4000000){aTarget[nIdx++]=0xf8+(nChar>>>24);aTarget[nIdx++]=0x80+((nChar>>>18)&0x3f);aTarget[nIdx++]=0x80+((nChar>>>12)&0x3f);aTarget[nIdx++]=0x80+((nChar>>>6)&0x3f);aTarget[nIdx++]=0x80+(nChar&0x3f);}else{aTarget[nIdx++]=0xfc+(nChar/1073741824);aTarget[nIdx++]=0x80+((nChar>>>24)&0x3f);aTarget[nIdx++]=0x80+((nChar>>>18)&0x3f);aTarget[nIdx++]=0x80+((nChar>>>12)&0x3f);aTarget[nIdx++]=0x80+((nChar>>>6)&0x3f);aTarget[nIdx++]=0x80+(nChar&0x3f);}
return nIdx;};StringView.getUTF8CharLength=function(nChar){return nChar<0x80?1:nChar<0x800?2:nChar<0x10000?3:nChar<0x200000?4:nChar<0x4000000?5:6;};StringView.loadUTF16CharCode=function(aChars,nIdx){var nFrstChr=aChars[nIdx];return nFrstChr>0xD7BF&&nIdx+1<aChars.length?(nFrstChr-0xD800<<10)+aChars[nIdx+1]+0x2400:nFrstChr;};StringView.putUTF16CharCode=function(aTarget,nChar,nPutAt){var nIdx=nPutAt;if(nChar<0x10000){aTarget[nIdx++]=nChar;}else{aTarget[nIdx++]=0xD7C0+(nChar>>>10);aTarget[nIdx++]=0xDC00+(nChar&0x3FF);}
return nIdx;};StringView.getUTF16CharLength=function(nChar){return nChar<0x10000?1:2;};StringView.b64ToUint6=function(nChr){return nChr>64&&nChr<91?nChr-65:nChr>96&&nChr<123?nChr-71:nChr>47&&nChr<58?nChr+4:nChr===43?62:nChr===47?63:0;};StringView.uint6ToB64=function(nUint6){return nUint6<26?nUint6+65:nUint6<52?nUint6+71:nUint6<62?nUint6-4:nUint6===62?43:nUint6===63?47:65;};StringView.bytesToBase64=function(aBytes){var sB64Enc="",nLen=aBytes.length,nUint24=0,nMod3,nIdx;for(nIdx=0;nIdx<nLen;nIdx++){nMod3=nIdx%3;if(nIdx>0&&(nIdx*4/3)%76===0){sB64Enc+="\r\n";}
nUint24|=aBytes[nIdx]<<(16>>>nMod3&24);if(nMod3===2||aBytes.length-nIdx===1){sB64Enc+=String.fromCharCode(StringView.uint6ToB64(nUint24>>>18&63),StringView.uint6ToB64(nUint24>>>12&63),StringView.uint6ToB64(nUint24>>>6&63),StringView.uint6ToB64(nUint24&63));nUint24=0;}}
return sB64Enc.replace(/A(?=A$|$)/g,"=");};StringView.base64ToBytes=function(sBase64,nBlockBytes){var sB64Enc=sBase64.replace(/[^A-Za-z0-9\+\/]/g,""),nInLen=sB64Enc.length,nOutLen=nBlockBytes?Math.ceil((nInLen*3+1>>>2)/nBlockBytes)*nBlockBytes:nInLen*3+1>>>2,aBytes=new Uint8Array(nOutLen),nMod3,nMod4,nUint24=0,nOutIdx=0,nInIdx;for(nInIdx=0;nInIdx<nInLen;nInIdx++){nMod4=nInIdx&3;nUint24|=StringView.b64ToUint6(sB64Enc.charCodeAt(nInIdx))<<18-6*nMod4;if(nMod4===3||nInLen-nInIdx===1){for(nMod3=0;nMod3<3&&nOutIdx<nOutLen;nMod3++,nOutIdx++){aBytes[nOutIdx]=nUint24>>>(16>>>nMod3&24)&255;}
nUint24=0;}}
return aBytes;};StringView.bytesToHex=function(buf){var bytes=Array.prototype.slice.call(new Uint8Array(buf)),i,j,str=[];if(buf.byteLength>0){str.push(("00"+bytes[0].toString(16)).substr(-2));}
for(i=1;i<buf.byteLength;i++){if(i%16===0){str.push("    ");for(j=i-16;j<i;j++){str.push(String.fromCharCode(bytes[j]).replace(/\s/," "));}
str.push('\n');}else if(i%8===0){str.push("  ");}else if(i%2===0){str.push(" ");}
str.push(("00"+bytes[i].toString(16)).substr(-2));}
return str.join('');};StringView.makeFromBase64=function(sB64Inpt,sEncoding,nByteOffset,nLength){return new StringView(sEncoding==="UTF-16"||sEncoding==="UTF-32"?StringView.base64ToBytes(sB64Inpt,sEncoding==="UTF-16"?2:4).buffer:StringView.base64ToBytes(sB64Inpt),sEncoding,nByteOffset,nLength);};StringView.prototype.encoding="UTF-8";StringView.prototype.makeIndex=function(nChrLength,nStartFrom){var aTarget=this.rawData,nChrEnd,nRawLength=aTarget.length,nStartIdx=nStartFrom||0,nIdxEnd=nStartIdx,nStopAtChr=isNaN(nChrLength)?Infinity:nChrLength,nPart;if(nChrLength+1>aTarget.length){throw new RangeError("StringView.prototype.makeIndex - The offset can\'t be major than the length of the array - 1.");}
switch(this.encoding){case"UTF-8":for(nChrEnd=0;nIdxEnd<nRawLength&&nChrEnd<nStopAtChr;nChrEnd++){nPart=aTarget[nIdxEnd];nIdxEnd+=nPart>251&&nPart<254&&nIdxEnd+5<nRawLength?6:nPart>247&&nPart<252&&nIdxEnd+4<nRawLength?5:nPart>239&&nPart<248&&nIdxEnd+3<nRawLength?4:nPart>223&&nPart<240&&nIdxEnd+2<nRawLength?3:nPart>191&&nPart<224&&nIdxEnd+1<nRawLength?2:1;}
break;case"UTF-16":for(nChrEnd=nStartIdx;nIdxEnd<nRawLength&&nChrEnd<nStopAtChr;nChrEnd++){nIdxEnd+=aTarget[nIdxEnd]>0xD7BF&&nIdxEnd+1<aTarget.length?2:1;}
break;default:nIdxEnd=nChrEnd=isFinite(nChrLength)?nChrLength:nRawLength-1;}
if(nChrLength){return nIdxEnd;}
return nChrEnd;};StringView.prototype.toBase64=function(bWholeBuffer){return StringView.bytesToBase64(bWholeBuffer?(this.bufferView.constructor===Uint8Array?this.bufferView:new Uint8Array(this.buffer)):this.rawData.constructor===Uint8Array?this.rawData:new Uint8Array(this.buffer,this.rawData.byteOffset,this.rawData.length<<(this.rawData.constructor===Uint16Array?1:2)));};StringView.prototype.subview=function(nCharOffset,nCharLength){var nChrLen,nCharStart,nStrLen,bVariableLen=this.encoding==="UTF-8"||this.encoding==="UTF-16",nStartOffset=nCharOffset,nStringLength,nRawLen=this.rawData.length;if(nRawLen===0){return new StringView(this.buffer,this.encoding);}
nStringLength=bVariableLen?this.makeIndex():nRawLen;nCharStart=nCharOffset?Math.max((nStringLength+nCharOffset)%nStringLength,0):0;nStrLen=Number.isInteger(nCharLength)?Math.max(nCharLength,0)+nCharStart>nStringLength?nStringLength-nCharStart:nCharLength:nStringLength;if(nCharStart===0&&nStrLen===nStringLength){return this;}
if(bVariableLen){nStartOffset=this.makeIndex(nCharStart);nChrLen=this.makeIndex(nStrLen,nStartOffset)-nStartOffset;}else{nStartOffset=nCharStart;nChrLen=nStrLen-nCharStart;}
if(this.encoding==="UTF-16"){nStartOffset<<=1;}else if(this.encoding==="UTF-32"){nStartOffset<<=2;}
return new StringView(this.buffer,this.encoding,nStartOffset,nChrLen);};StringView.prototype.forEachChar=function(fCallback,oThat,nChrOffset,nChrLen){var aSource=this.rawData,nRawEnd,nRawIdx,fGetInptChrSize,fGetInptChrCode,nChrCode,nChrIdx;if(this.encoding==="UTF-8"||this.encoding==="UTF-16"){if(this.encoding==="UTF-8"){fGetInptChrSize=StringView.getUTF8CharLength;fGetInptChrCode=StringView.loadUTF8CharCode;}else if(this.encoding==="UTF-16"){fGetInptChrSize=StringView.getUTF16CharLength;fGetInptChrCode=StringView.loadUTF16CharCode;}
nRawIdx=isFinite(nChrOffset)?this.makeIndex(nChrOffset):0;nRawEnd=isFinite(nChrLen)?this.makeIndex(nChrLen,nRawIdx):aSource.length;for(nChrIdx=0;nRawIdx<nRawEnd;nChrIdx++){nChrCode=fGetInptChrCode(aSource,nRawIdx);fCallback.call(oThat||null,nChrCode,nChrIdx,nRawIdx,aSource);nRawIdx+=fGetInptChrSize(nChrCode);}}else{nRawIdx=isFinite(nChrOffset)?nChrOffset:0;nRawEnd=isFinite(nChrLen)?nChrLen+nRawIdx:aSource.length;for(nRawIdx;nRawIdx<nRawEnd;nRawIdx++){fCallback.call(oThat||null,aSource[nRawIdx],nRawIdx,nRawIdx,aSource);}}};StringView.prototype.valueOf=StringView.prototype.toString=function(){var fGetCode,fGetIncr,sView="",nChr,nLen=this.rawData.length,nIdx;if(this.encoding!=="UTF-8"&&this.encoding!=="UTF-16"){return String.fromCharCode.apply(null,this.rawData);}
if(this.encoding==="UTF-8"){fGetIncr=StringView.getUTF8CharLength;fGetCode=StringView.loadUTF8CharCode;}else if(this.encoding==="UTF-16"){fGetIncr=StringView.getUTF16CharLength;fGetCode=StringView.loadUTF16CharCode;}
for(nIdx=0;nIdx<nLen;nIdx+=fGetIncr(nChr)){nChr=fGetCode(this.rawData,nIdx);sView+=String.fromCharCode(nChr);}
return sView;};}());var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=Base64._utf8_encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
Base64._keyStr.charAt(enc1)+Base64._keyStr.charAt(enc2)+
Base64._keyStr.charAt(enc3)+Base64._keyStr.charAt(enc4);}
return output;},decode:function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=Base64._keyStr.indexOf(input.charAt(i++));enc2=Base64._keyStr.indexOf(input.charAt(i++));enc3=Base64._keyStr.indexOf(input.charAt(i++));enc4=Base64._keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}
if(enc4!=64){output=output+String.fromCharCode(chr3);}}
output=Base64._utf8_decode(output);return output;},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;},_utf8_decode:function(utftext){var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}
else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}
else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}
return string;}}
function diff_match_patch(){this.Diff_Timeout=1.0;this.Diff_EditCost=4;this.Match_Threshold=0.375;this.Match_Distance=100;this.Patch_DeleteThreshold=0.375;this.Patch_Margin=4;this.Match_MaxBits=32;}
var DIFF_DELETE=-1;var DIFF_INSERT=1;var DIFF_EQUAL=0;diff_match_patch.Diff;diff_match_patch.prototype.diff_main=function(text1,text2,opt_checklines,opt_deadline){if(typeof opt_deadline=='undefined'){if(this.Diff_Timeout<=0){opt_deadline=Number.MAX_VALUE;}else{opt_deadline=(new Date).getTime()+this.Diff_Timeout*1000;}}
var deadline=opt_deadline;if(text1==null||text2==null){throw new Error('Null input. (diff_main)');}
if(text1==text2){if(text1){return[[DIFF_EQUAL,text1]];}
return[];}
if(typeof opt_checklines=='undefined'){opt_checklines=true;}
var checklines=opt_checklines;var commonlength=this.diff_commonPrefix(text1,text2);var commonprefix=text1.substring(0,commonlength);text1=text1.substring(commonlength);text2=text2.substring(commonlength);commonlength=this.diff_commonSuffix(text1,text2);var commonsuffix=text1.substring(text1.length-commonlength);text1=text1.substring(0,text1.length-commonlength);text2=text2.substring(0,text2.length-commonlength);var diffs=this.diff_compute_(text1,text2,checklines,deadline);if(commonprefix){diffs.unshift([DIFF_EQUAL,commonprefix]);}
if(commonsuffix){diffs.push([DIFF_EQUAL,commonsuffix]);}
this.diff_cleanupMerge(diffs);return diffs;};diff_match_patch.prototype.diff_compute_=function(text1,text2,checklines,deadline){var diffs;if(!text1){return[[DIFF_INSERT,text2]];}
if(!text2){return[[DIFF_DELETE,text1]];}
var longtext=text1.length>text2.length?text1:text2;var shorttext=text1.length>text2.length?text2:text1;var i=longtext.indexOf(shorttext);if(i!=-1){diffs=[[DIFF_INSERT,longtext.substring(0,i)],[DIFF_EQUAL,shorttext],[DIFF_INSERT,longtext.substring(i+shorttext.length)]];if(text1.length>text2.length){diffs[0][0]=diffs[2][0]=DIFF_DELETE;}
return diffs;}
if(shorttext.length==1){return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]];}
var hm=this.diff_halfMatch_(text1,text2);if(hm){var text1_a=hm[0];var text1_b=hm[1];var text2_a=hm[2];var text2_b=hm[3];var mid_common=hm[4];var diffs_a=this.diff_main(text1_a,text2_a,checklines,deadline);var diffs_b=this.diff_main(text1_b,text2_b,checklines,deadline);return diffs_a.concat([[DIFF_EQUAL,mid_common]],diffs_b);}
if(checklines&&text1.length>100&&text2.length>100){return this.diff_lineMode_(text1,text2,deadline);}
return this.diff_bisect_(text1,text2,deadline);};diff_match_patch.prototype.diff_lineMode_=function(text1,text2,deadline){var a=this.diff_linesToChars_(text1,text2);text1=a.chars1;text2=a.chars2;var linearray=a.lineArray;var diffs=this.diff_main(text1,text2,false,deadline);this.diff_charsToLines_(diffs,linearray);this.diff_cleanupSemantic(diffs);diffs.push([DIFF_EQUAL,'']);var pointer=0;var count_delete=0;var count_insert=0;var text_delete='';var text_insert='';while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++;text_insert+=diffs[pointer][1];break;case DIFF_DELETE:count_delete++;text_delete+=diffs[pointer][1];break;case DIFF_EQUAL:if(count_delete>=1&&count_insert>=1){diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert);pointer=pointer-count_delete-count_insert;var a=this.diff_main(text_delete,text_insert,false,deadline);for(var j=a.length-1;j>=0;j--){diffs.splice(pointer,0,a[j]);}
pointer=pointer+a.length;}
count_insert=0;count_delete=0;text_delete='';text_insert='';break;}
pointer++;}
diffs.pop();return diffs;};diff_match_patch.prototype.diff_bisect_=function(text1,text2,deadline){var text1_length=text1.length;var text2_length=text2.length;var max_d=Math.ceil((text1_length+text2_length)/2);var v_offset=max_d;var v_length=2*max_d;var v1=new Array(v_length);var v2=new Array(v_length);for(var x=0;x<v_length;x++){v1[x]=-1;v2[x]=-1;}
v1[v_offset+1]=0;v2[v_offset+1]=0;var delta=text1_length-text2_length;var front=(delta%2!=0);var k1start=0;var k1end=0;var k2start=0;var k2end=0;for(var d=0;d<max_d;d++){if((new Date()).getTime()>deadline){break;}
for(var k1=-d+k1start;k1<=d-k1end;k1+=2){var k1_offset=v_offset+k1;var x1;if(k1==-d||(k1!=d&&v1[k1_offset-1]<v1[k1_offset+1])){x1=v1[k1_offset+1];}else{x1=v1[k1_offset-1]+1;}
var y1=x1-k1;while(x1<text1_length&&y1<text2_length&&text1.charAt(x1)==text2.charAt(y1)){x1++;y1++;}
v1[k1_offset]=x1;if(x1>text1_length){k1end+=2;}else if(y1>text2_length){k1start+=2;}else if(front){var k2_offset=v_offset+delta-k1;if(k2_offset>=0&&k2_offset<v_length&&v2[k2_offset]!=-1){var x2=text1_length-v2[k2_offset];if(x1>=x2){return this.diff_bisectSplit_(text1,text2,x1,y1,deadline);}}}}
for(var k2=-d+k2start;k2<=d-k2end;k2+=2){var k2_offset=v_offset+k2;var x2;if(k2==-d||(k2!=d&&v2[k2_offset-1]<v2[k2_offset+1])){x2=v2[k2_offset+1];}else{x2=v2[k2_offset-1]+1;}
var y2=x2-k2;while(x2<text1_length&&y2<text2_length&&text1.charAt(text1_length-x2-1)==text2.charAt(text2_length-y2-1)){x2++;y2++;}
v2[k2_offset]=x2;if(x2>text1_length){k2end+=2;}else if(y2>text2_length){k2start+=2;}else if(!front){var k1_offset=v_offset+delta-k2;if(k1_offset>=0&&k1_offset<v_length&&v1[k1_offset]!=-1){var x1=v1[k1_offset];var y1=v_offset+x1-k1_offset;x2=text1_length-x2;if(x1>=x2){return this.diff_bisectSplit_(text1,text2,x1,y1,deadline);}}}}}
return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]];};diff_match_patch.prototype.diff_bisectSplit_=function(text1,text2,x,y,deadline){var text1a=text1.substring(0,x);var text2a=text2.substring(0,y);var text1b=text1.substring(x);var text2b=text2.substring(y);var diffs=this.diff_main(text1a,text2a,false,deadline);var diffsb=this.diff_main(text1b,text2b,false,deadline);return diffs.concat(diffsb);};diff_match_patch.prototype.diff_linesToChars_=function(text1,text2){var lineArray=[];var lineHash={};lineArray[0]='';function diff_linesToCharsMunge_(text){var chars='';var lineStart=0;var lineEnd=-1;var lineArrayLength=lineArray.length;while(lineEnd<text.length-1){lineEnd=text.indexOf('\n',lineStart);if(lineEnd==-1){lineEnd=text.length-1;}
var line=text.substring(lineStart,lineEnd+1);lineStart=lineEnd+1;if(lineHash.hasOwnProperty?lineHash.hasOwnProperty(line):(lineHash[line]!==undefined)){chars+=String.fromCharCode(lineHash[line]);}else{chars+=String.fromCharCode(lineArrayLength);lineHash[line]=lineArrayLength;lineArray[lineArrayLength++]=line;}}
return chars;}
var chars1=diff_linesToCharsMunge_(text1);var chars2=diff_linesToCharsMunge_(text2);return{chars1:chars1,chars2:chars2,lineArray:lineArray};};diff_match_patch.prototype.diff_charsToLines_=function(diffs,lineArray){for(var x=0;x<diffs.length;x++){var chars=diffs[x][1];var text=[];for(var y=0;y<chars.length;y++){text[y]=lineArray[chars.charCodeAt(y)];}
diffs[x][1]=text.join('');}};diff_match_patch.prototype.diff_commonPrefix=function(text1,text2){if(!text1||!text2||text1.charAt(0)!=text2.charAt(0)){return 0;}
var pointermin=0;var pointermax=Math.min(text1.length,text2.length);var pointermid=pointermax;var pointerstart=0;while(pointermin<pointermid){if(text1.substring(pointerstart,pointermid)==text2.substring(pointerstart,pointermid)){pointermin=pointermid;pointerstart=pointermin;}else{pointermax=pointermid;}
pointermid=Math.floor((pointermax-pointermin)/2+pointermin);}
return pointermid;};diff_match_patch.prototype.diff_commonSuffix=function(text1,text2){if(!text1||!text2||text1.charAt(text1.length-1)!=text2.charAt(text2.length-1)){return 0;}
var pointermin=0;var pointermax=Math.min(text1.length,text2.length);var pointermid=pointermax;var pointerend=0;while(pointermin<pointermid){if(text1.substring(text1.length-pointermid,text1.length-pointerend)==text2.substring(text2.length-pointermid,text2.length-pointerend)){pointermin=pointermid;pointerend=pointermin;}else{pointermax=pointermid;}
pointermid=Math.floor((pointermax-pointermin)/2+pointermin);}
return pointermid;};diff_match_patch.prototype.diff_commonOverlap_=function(text1,text2){var text1_length=text1.length;var text2_length=text2.length;if(text1_length==0||text2_length==0){return 0;}
if(text1_length>text2_length){text1=text1.substring(text1_length-text2_length);}else if(text1_length<text2_length){text2=text2.substring(0,text1_length);}
var text_length=Math.min(text1_length,text2_length);if(text1==text2){return text_length;}
var best=0;var length=1;while(true){var pattern=text1.substring(text_length-length);var found=text2.indexOf(pattern);if(found==-1){return best;}
length+=found;if(found==0||text1.substring(text_length-length)==text2.substring(0,length)){best=length;length++;}}};diff_match_patch.prototype.diff_halfMatch_=function(text1,text2){if(this.Diff_Timeout<=0){return null;}
var longtext=text1.length>text2.length?text1:text2;var shorttext=text1.length>text2.length?text2:text1;if(longtext.length<4||shorttext.length*2<longtext.length){return null;}
var dmp=this;function diff_halfMatchI_(longtext,shorttext,i){var seed=longtext.substring(i,i+Math.floor(longtext.length/4));var j=-1;var best_common='';var best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b;while((j=shorttext.indexOf(seed,j+1))!=-1){var prefixLength=dmp.diff_commonPrefix(longtext.substring(i),shorttext.substring(j));var suffixLength=dmp.diff_commonSuffix(longtext.substring(0,i),shorttext.substring(0,j));if(best_common.length<suffixLength+prefixLength){best_common=shorttext.substring(j-suffixLength,j)+
shorttext.substring(j,j+prefixLength);best_longtext_a=longtext.substring(0,i-suffixLength);best_longtext_b=longtext.substring(i+prefixLength);best_shorttext_a=shorttext.substring(0,j-suffixLength);best_shorttext_b=shorttext.substring(j+prefixLength);}}
if(best_common.length*2>=longtext.length){return[best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b,best_common];}else{return null;}}
var hm1=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/4));var hm2=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/2));var hm;if(!hm1&&!hm2){return null;}else if(!hm2){hm=hm1;}else if(!hm1){hm=hm2;}else{hm=hm1[4].length>hm2[4].length?hm1:hm2;}
var text1_a,text1_b,text2_a,text2_b;if(text1.length>text2.length){text1_a=hm[0];text1_b=hm[1];text2_a=hm[2];text2_b=hm[3];}else{text2_a=hm[0];text2_b=hm[1];text1_a=hm[2];text1_b=hm[3];}
var mid_common=hm[4];return[text1_a,text1_b,text2_a,text2_b,mid_common];};diff_match_patch.prototype.diff_cleanupSemantic=function(diffs){var changes=false;var equalities=[];var equalitiesLength=0;var lastequality=null;var pointer=0;var length_insertions1=0;var length_deletions1=0;var length_insertions2=0;var length_deletions2=0;while(pointer<diffs.length){if(diffs[pointer][0]==DIFF_EQUAL){equalities[equalitiesLength++]=pointer;length_insertions1=length_insertions2;length_deletions1=length_deletions2;length_insertions2=0;length_deletions2=0;lastequality=diffs[pointer][1];}else{if(diffs[pointer][0]==DIFF_INSERT){length_insertions2+=diffs[pointer][1].length;}else{length_deletions2+=diffs[pointer][1].length;}
if(lastequality&&(lastequality.length<=Math.max(length_insertions1,length_deletions1))&&(lastequality.length<=Math.max(length_insertions2,length_deletions2))){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;length_insertions1=0;length_deletions1=0;length_insertions2=0;length_deletions2=0;lastequality=null;changes=true;}}
pointer++;}
if(changes){this.diff_cleanupMerge(diffs);}
this.diff_cleanupSemanticLossless(diffs);pointer=1;while(pointer<diffs.length){if(diffs[pointer-1][0]==DIFF_DELETE&&diffs[pointer][0]==DIFF_INSERT){var deletion=diffs[pointer-1][1];var insertion=diffs[pointer][1];var overlap_length1=this.diff_commonOverlap_(deletion,insertion);var overlap_length2=this.diff_commonOverlap_(insertion,deletion);if(overlap_length1>=overlap_length2){if(overlap_length1>=deletion.length/2||overlap_length1>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,insertion.substring(0,overlap_length1)]);diffs[pointer-1][1]=deletion.substring(0,deletion.length-overlap_length1);diffs[pointer+1][1]=insertion.substring(overlap_length1);pointer++;}}else{if(overlap_length2>=deletion.length/2||overlap_length2>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,deletion.substring(0,overlap_length2)]);diffs[pointer-1][0]=DIFF_INSERT;diffs[pointer-1][1]=insertion.substring(0,insertion.length-overlap_length2);diffs[pointer+1][0]=DIFF_DELETE;diffs[pointer+1][1]=deletion.substring(overlap_length2);pointer++;}}
pointer++;}
pointer++;}};diff_match_patch.prototype.diff_cleanupSemanticLossless=function(diffs){function diff_cleanupSemanticScore_(one,two){if(!one||!two){return 6;}
var char1=one.charAt(one.length-1);var char2=two.charAt(0);var nonAlphaNumeric1=char1.match(diff_match_patch.nonAlphaNumericRegex_);var nonAlphaNumeric2=char2.match(diff_match_patch.nonAlphaNumericRegex_);var whitespace1=nonAlphaNumeric1&&char1.match(diff_match_patch.whitespaceRegex_);var whitespace2=nonAlphaNumeric2&&char2.match(diff_match_patch.whitespaceRegex_);var lineBreak1=whitespace1&&char1.match(diff_match_patch.linebreakRegex_);var lineBreak2=whitespace2&&char2.match(diff_match_patch.linebreakRegex_);var blankLine1=lineBreak1&&one.match(diff_match_patch.blanklineEndRegex_);var blankLine2=lineBreak2&&two.match(diff_match_patch.blanklineStartRegex_);if(blankLine1||blankLine2){return 5;}else if(lineBreak1||lineBreak2){return 4;}else if(nonAlphaNumeric1&&!whitespace1&&whitespace2){return 3;}else if(whitespace1||whitespace2){return 2;}else if(nonAlphaNumeric1||nonAlphaNumeric2){return 1;}
return 0;}
var pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL){var equality1=diffs[pointer-1][1];var edit=diffs[pointer][1];var equality2=diffs[pointer+1][1];var commonOffset=this.diff_commonSuffix(equality1,edit);if(commonOffset){var commonString=edit.substring(edit.length-commonOffset);equality1=equality1.substring(0,equality1.length-commonOffset);edit=commonString+edit.substring(0,edit.length-commonOffset);equality2=commonString+equality2;}
var bestEquality1=equality1;var bestEdit=edit;var bestEquality2=equality2;var bestScore=diff_cleanupSemanticScore_(equality1,edit)+
diff_cleanupSemanticScore_(edit,equality2);while(edit.charAt(0)===equality2.charAt(0)){equality1+=edit.charAt(0);edit=edit.substring(1)+equality2.charAt(0);equality2=equality2.substring(1);var score=diff_cleanupSemanticScore_(equality1,edit)+
diff_cleanupSemanticScore_(edit,equality2);if(score>=bestScore){bestScore=score;bestEquality1=equality1;bestEdit=edit;bestEquality2=equality2;}}
if(diffs[pointer-1][1]!=bestEquality1){if(bestEquality1){diffs[pointer-1][1]=bestEquality1;}else{diffs.splice(pointer-1,1);pointer--;}
diffs[pointer][1]=bestEdit;if(bestEquality2){diffs[pointer+1][1]=bestEquality2;}else{diffs.splice(pointer+1,1);pointer--;}}}
pointer++;}};diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;diff_match_patch.whitespaceRegex_=/\s/;diff_match_patch.linebreakRegex_=/[\r\n]/;diff_match_patch.blanklineEndRegex_=/\n\r?\n$/;diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/;diff_match_patch.prototype.diff_cleanupEfficiency=function(diffs){var changes=false;var equalities=[];var equalitiesLength=0;var lastequality=null;var pointer=0;var pre_ins=false;var pre_del=false;var post_ins=false;var post_del=false;while(pointer<diffs.length){if(diffs[pointer][0]==DIFF_EQUAL){if(diffs[pointer][1].length<this.Diff_EditCost&&(post_ins||post_del)){equalities[equalitiesLength++]=pointer;pre_ins=post_ins;pre_del=post_del;lastequality=diffs[pointer][1];}else{equalitiesLength=0;lastequality=null;}
post_ins=post_del=false;}else{if(diffs[pointer][0]==DIFF_DELETE){post_del=true;}else{post_ins=true;}
if(lastequality&&((pre_ins&&pre_del&&post_ins&&post_del)||((lastequality.length<this.Diff_EditCost/2)&&(pre_ins+pre_del+post_ins+post_del)==3))){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;lastequality=null;if(pre_ins&&pre_del){post_ins=post_del=true;equalitiesLength=0;}else{equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;post_ins=post_del=false;}
changes=true;}}
pointer++;}
if(changes){this.diff_cleanupMerge(diffs);}};diff_match_patch.prototype.diff_cleanupMerge=function(diffs){diffs.push([DIFF_EQUAL,'']);var pointer=0;var count_delete=0;var count_insert=0;var text_delete='';var text_insert='';var commonlength;while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++;text_insert+=diffs[pointer][1];pointer++;break;case DIFF_DELETE:count_delete++;text_delete+=diffs[pointer][1];pointer++;break;case DIFF_EQUAL:if(count_delete+count_insert>1){if(count_delete!==0&&count_insert!==0){commonlength=this.diff_commonPrefix(text_insert,text_delete);if(commonlength!==0){if((pointer-count_delete-count_insert)>0&&diffs[pointer-count_delete-count_insert-1][0]==DIFF_EQUAL){diffs[pointer-count_delete-count_insert-1][1]+=text_insert.substring(0,commonlength);}else{diffs.splice(0,0,[DIFF_EQUAL,text_insert.substring(0,commonlength)]);pointer++;}
text_insert=text_insert.substring(commonlength);text_delete=text_delete.substring(commonlength);}
commonlength=this.diff_commonSuffix(text_insert,text_delete);if(commonlength!==0){diffs[pointer][1]=text_insert.substring(text_insert.length-
commonlength)+diffs[pointer][1];text_insert=text_insert.substring(0,text_insert.length-
commonlength);text_delete=text_delete.substring(0,text_delete.length-
commonlength);}}
if(count_delete===0){diffs.splice(pointer-count_insert,count_delete+count_insert,[DIFF_INSERT,text_insert]);}else if(count_insert===0){diffs.splice(pointer-count_delete,count_delete+count_insert,[DIFF_DELETE,text_delete]);}else{diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert,[DIFF_DELETE,text_delete],[DIFF_INSERT,text_insert]);}
pointer=pointer-count_delete-count_insert+
(count_delete?1:0)+(count_insert?1:0)+1;}else if(pointer!==0&&diffs[pointer-1][0]==DIFF_EQUAL){diffs[pointer-1][1]+=diffs[pointer][1];diffs.splice(pointer,1);}else{pointer++;}
count_insert=0;count_delete=0;text_delete='';text_insert='';break;}}
if(diffs[diffs.length-1][1]===''){diffs.pop();}
var changes=false;pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL){if(diffs[pointer][1].substring(diffs[pointer][1].length-
diffs[pointer-1][1].length)==diffs[pointer-1][1]){diffs[pointer][1]=diffs[pointer-1][1]+
diffs[pointer][1].substring(0,diffs[pointer][1].length-
diffs[pointer-1][1].length);diffs[pointer+1][1]=diffs[pointer-1][1]+diffs[pointer+1][1];diffs.splice(pointer-1,1);changes=true;}else if(diffs[pointer][1].substring(0,diffs[pointer+1][1].length)==diffs[pointer+1][1]){diffs[pointer-1][1]+=diffs[pointer+1][1];diffs[pointer][1]=diffs[pointer][1].substring(diffs[pointer+1][1].length)+
diffs[pointer+1][1];diffs.splice(pointer+1,1);changes=true;}}
pointer++;}
if(changes){this.diff_cleanupMerge(diffs);}};diff_match_patch.prototype.diff_xIndex=function(diffs,loc){var chars1=0;var chars2=0;var last_chars1=0;var last_chars2=0;var x;for(x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_INSERT){chars1+=diffs[x][1].length;}
if(diffs[x][0]!==DIFF_DELETE){chars2+=diffs[x][1].length;}
if(chars1>loc){break;}
last_chars1=chars1;last_chars2=chars2;}
if(diffs.length!=x&&diffs[x][0]===DIFF_DELETE){return last_chars2;}
return last_chars2+(loc-last_chars1);};diff_match_patch.prototype.diff_prettyHtml=function(diffs){var html=[];var pattern_amp=/&/g;var pattern_lt=/</g;var pattern_gt=/>/g;var pattern_para=/\n/g;for(var x=0;x<diffs.length;x++){var op=diffs[x][0];var data=diffs[x][1];var text=data.replace(pattern_amp,'&amp;').replace(pattern_lt,'&lt;').replace(pattern_gt,'&gt;').replace(pattern_para,'&para;<br>');switch(op){case DIFF_INSERT:html[x]='<ins style="background:#e6ffe6;">'+text+'</ins>';break;case DIFF_DELETE:html[x]='<del style="background:#ffe6e6;">'+text+'</del>';break;case DIFF_EQUAL:html[x]='<span>'+text+'</span>';break;}}
return html.join('');};diff_match_patch.prototype.diff_text1=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_INSERT){text[x]=diffs[x][1];}}
return text.join('');};diff_match_patch.prototype.diff_text2=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_DELETE){text[x]=diffs[x][1];}}
return text.join('');};diff_match_patch.prototype.diff_levenshtein=function(diffs){var levenshtein=0;var insertions=0;var deletions=0;for(var x=0;x<diffs.length;x++){var op=diffs[x][0];var data=diffs[x][1];switch(op){case DIFF_INSERT:insertions+=data.length;break;case DIFF_DELETE:deletions+=data.length;break;case DIFF_EQUAL:levenshtein+=Math.max(insertions,deletions);insertions=0;deletions=0;break;}}
levenshtein+=Math.max(insertions,deletions);return levenshtein;};diff_match_patch.prototype.diff_toDelta=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){switch(diffs[x][0]){case DIFF_INSERT:text[x]='+'+encodeURI(diffs[x][1]);break;case DIFF_DELETE:text[x]='-'+diffs[x][1].length;break;case DIFF_EQUAL:text[x]='='+diffs[x][1].length;break;}}
return text.join('\t').replace(/%20/g,' ');};diff_match_patch.prototype.diff_fromDelta=function(text1,delta){var diffs=[];var diffsLength=0;var pointer=0;var tokens=delta.split(/\t/g);for(var x=0;x<tokens.length;x++){var param=tokens[x].substring(1);switch(tokens[x].charAt(0)){case'+':try{diffs[diffsLength++]=[DIFF_INSERT,decodeURI(param)];}catch(ex){throw new Error('Illegal escape in diff_fromDelta: '+param);}
break;case'-':case'=':var n=parseInt(param,10);if(isNaN(n)||n<0){throw new Error('Invalid number in diff_fromDelta: '+param);}
var text=text1.substring(pointer,pointer+=n);if(tokens[x].charAt(0)=='='){diffs[diffsLength++]=[DIFF_EQUAL,text];}else{diffs[diffsLength++]=[DIFF_DELETE,text];}
break;default:if(tokens[x]){throw new Error('Invalid diff operation in diff_fromDelta: '+
tokens[x]);}}}
if(pointer!=text1.length){throw new Error('Delta length ('+pointer+') does not equal source text length ('+text1.length+').');}
return diffs;};diff_match_patch.prototype.match_main=function(text,pattern,loc){if(text==null||pattern==null||loc==null){throw new Error('Null input. (match_main)');}
loc=Math.max(0,Math.min(loc,text.length));if(text==pattern){return 0;}else if(!text.length){return-1;}else if(text.substring(loc,loc+pattern.length)==pattern){return loc;}else{return this.match_bitap_(text,pattern,loc);}};diff_match_patch.prototype.match_bitap_=function(text,pattern,loc){if(pattern.length>this.Match_MaxBits){throw new Error('Pattern too long for this browser.');}
var s=this.match_alphabet_(pattern);var dmp=this;function match_bitapScore_(e,x){var accuracy=e/pattern.length;var proximity=Math.abs(loc-x);if(!dmp.Match_Distance){return proximity?1.0:accuracy;}
return accuracy+(proximity/dmp.Match_Distance);}
var score_threshold=this.Match_Threshold;var best_loc=text.indexOf(pattern,loc);if(best_loc!=-1){score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold);best_loc=text.lastIndexOf(pattern,loc+pattern.length);if(best_loc!=-1){score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold);}}
var matchmask=1<<(pattern.length-1);best_loc=-1;var bin_min,bin_mid;var bin_max=pattern.length+text.length;var last_rd;for(var d=0;d<pattern.length;d++){bin_min=0;bin_mid=bin_max;while(bin_min<bin_mid){if(match_bitapScore_(d,loc+bin_mid)<=score_threshold){bin_min=bin_mid;}else{bin_max=bin_mid;}
bin_mid=Math.floor((bin_max-bin_min)/2+bin_min);}
bin_max=bin_mid;var start=Math.max(1,loc-bin_mid+1);var finish=Math.min(loc+bin_mid,text.length)+pattern.length;var rd=Array(finish+2);rd[finish+1]=(1<<d)-1;for(var j=finish;j>=start;j--){var charMatch=s[text.charAt(j-1)];if(d===0){rd[j]=((rd[j+1]<<1)|1)&charMatch;}else{rd[j]=(((rd[j+1]<<1)|1)&charMatch)|(((last_rd[j+1]|last_rd[j])<<1)|1)|last_rd[j+1];}
if(rd[j]&matchmask){var score=match_bitapScore_(d,j-1);if(score<=score_threshold){score_threshold=score;best_loc=j-1;if(best_loc>loc){start=Math.max(1,2*loc-best_loc);}else{break;}}}}
if(match_bitapScore_(d+1,loc)>score_threshold){break;}
last_rd=rd;}
return best_loc;};diff_match_patch.prototype.match_alphabet_=function(pattern){var s={};for(var i=0;i<pattern.length;i++){s[pattern.charAt(i)]=0;}
for(var i=0;i<pattern.length;i++){s[pattern.charAt(i)]|=1<<(pattern.length-i-1);}
return s;};diff_match_patch.prototype.patch_addContext_=function(patch,text){if(text.length==0){return;}
var pattern=text.substring(patch.start2,patch.start2+patch.length1);var padding=0;while(text.indexOf(pattern)!=text.lastIndexOf(pattern)&&pattern.length<this.Match_MaxBits-this.Patch_Margin-
this.Patch_Margin){padding+=this.Patch_Margin;pattern=text.substring(patch.start2-padding,patch.start2+patch.length1+padding);}
padding+=this.Patch_Margin;var prefix=text.substring(patch.start2-padding,patch.start2);if(prefix){patch.diffs.unshift([DIFF_EQUAL,prefix]);}
var suffix=text.substring(patch.start2+patch.length1,patch.start2+patch.length1+padding);if(suffix){patch.diffs.push([DIFF_EQUAL,suffix]);}
patch.start1-=prefix.length;patch.start2-=prefix.length;patch.length1+=prefix.length+suffix.length;patch.length2+=prefix.length+suffix.length;};diff_match_patch.prototype.patch_make=function(a,opt_b,opt_c){var text1,diffs;if(typeof a=='string'&&typeof opt_b=='string'&&typeof opt_c=='undefined'){text1=(a);diffs=this.diff_main(text1,(opt_b),true);if(diffs.length>2){this.diff_cleanupSemantic(diffs);this.diff_cleanupEfficiency(diffs);}}else if(a&&typeof a=='object'&&typeof opt_b=='undefined'&&typeof opt_c=='undefined'){diffs=(a);text1=this.diff_text1(diffs);}else if(typeof a=='string'&&opt_b&&typeof opt_b=='object'&&typeof opt_c=='undefined'){text1=(a);diffs=(opt_b);}else if(typeof a=='string'&&typeof opt_b=='string'&&opt_c&&typeof opt_c=='object'){text1=(a);diffs=(opt_c);}else{throw new Error('Unknown call format to patch_make.');}
if(diffs.length===0){return[];}
var patches=[];var patch=new diff_match_patch.patch_obj();var patchDiffLength=0;var char_count1=0;var char_count2=0;var prepatch_text=text1;var postpatch_text=text1;for(var x=0;x<diffs.length;x++){var diff_type=diffs[x][0];var diff_text=diffs[x][1];if(!patchDiffLength&&diff_type!==DIFF_EQUAL){patch.start1=char_count1;patch.start2=char_count2;}
switch(diff_type){case DIFF_INSERT:patch.diffs[patchDiffLength++]=diffs[x];patch.length2+=diff_text.length;postpatch_text=postpatch_text.substring(0,char_count2)+diff_text+
postpatch_text.substring(char_count2);break;case DIFF_DELETE:patch.length1+=diff_text.length;patch.diffs[patchDiffLength++]=diffs[x];postpatch_text=postpatch_text.substring(0,char_count2)+
postpatch_text.substring(char_count2+
diff_text.length);break;case DIFF_EQUAL:if(diff_text.length<=2*this.Patch_Margin&&patchDiffLength&&diffs.length!=x+1){patch.diffs[patchDiffLength++]=diffs[x];patch.length1+=diff_text.length;patch.length2+=diff_text.length;}else if(diff_text.length>=2*this.Patch_Margin){if(patchDiffLength){this.patch_addContext_(patch,prepatch_text);patches.push(patch);patch=new diff_match_patch.patch_obj();patchDiffLength=0;prepatch_text=postpatch_text;char_count1=char_count2;}}
break;}
if(diff_type!==DIFF_INSERT){char_count1+=diff_text.length;}
if(diff_type!==DIFF_DELETE){char_count2+=diff_text.length;}}
if(patchDiffLength){this.patch_addContext_(patch,prepatch_text);patches.push(patch);}
return patches;};diff_match_patch.prototype.patch_deepCopy=function(patches){var patchesCopy=[];for(var x=0;x<patches.length;x++){var patch=patches[x];var patchCopy=new diff_match_patch.patch_obj();patchCopy.diffs=[];for(var y=0;y<patch.diffs.length;y++){patchCopy.diffs[y]=patch.diffs[y].slice();}
patchCopy.start1=patch.start1;patchCopy.start2=patch.start2;patchCopy.length1=patch.length1;patchCopy.length2=patch.length2;patchesCopy[x]=patchCopy;}
return patchesCopy;};diff_match_patch.prototype.patch_apply=function(patches,text){if(patches.length==0){return[text,[]];}
patches=this.patch_deepCopy(patches);var nullPadding=this.patch_addPadding(patches);text=nullPadding+text+nullPadding;this.patch_splitMax(patches);var delta=0;var results=[];var positions=[];for(var x=0;x<patches.length;x++){var position=[3,0,""];var expected_loc=patches[x].start2+delta;var text1=this.diff_text1(patches[x].diffs);var start_loc;var replacement_str;var end_loc=-1;if(text1.length>this.Match_MaxBits){start_loc=this.match_main(text,text1.substring(0,this.Match_MaxBits),expected_loc);if(start_loc!=-1){end_loc=this.match_main(text,text1.substring(text1.length-this.Match_MaxBits),expected_loc+text1.length-this.Match_MaxBits);if(end_loc==-1||start_loc>=end_loc){start_loc=-1;}}}else{start_loc=this.match_main(text,text1,expected_loc);}
if(start_loc==-1){results[x]=false;delta-=patches[x].length2-patches[x].length1;}else{results[x]=true;delta=start_loc-expected_loc;var text2;if(end_loc==-1){text2=text.substring(start_loc,start_loc+text1.length);}else{text2=text.substring(start_loc,end_loc+this.Match_MaxBits);}
if(text1==text2){replacement_str=this.diff_text2(patches[x].diffs);text=text.substring(0,start_loc)+
replacement_str+
text.substring(start_loc+text1.length);position=[start_loc,text1.length,replacement_str];}else{var diffs=this.diff_main(text1,text2,false);if(text1.length>this.Match_MaxBits&&this.diff_levenshtein(diffs)/text1.length>this.Patch_DeleteThreshold){results[x]=false;}else{this.diff_cleanupSemanticLossless(diffs);var index1=0;var index2;var delete_len=0;var inserted_text="";for(var y=0;y<patches[x].diffs.length;y++){var mod=patches[x].diffs[y];if(mod[0]!==DIFF_EQUAL){index2=this.diff_xIndex(diffs,index1);}
if(mod[0]===DIFF_INSERT){text=text.substring(0,start_loc+index2)+mod[1]+
text.substring(start_loc+index2);inserted_text+=mod[1];}else if(mod[0]===DIFF_DELETE){var diff_index=this.diff_xIndex(diffs,index1+mod[1].length);text=text.substring(0,start_loc+index2)+
text.substring(start_loc+diff_index);delete_len+=(diff_index-index2);}
if(mod[0]!==DIFF_DELETE){index1+=mod[1].length;}}
position=[start_loc,delete_len,inserted_text];}}}
np_len=nullPadding.length;if(position[0]<np_len){position[1]-=np_len-position[0];position[2]=position[2].substring(np_len-position[0]);position[0]=0;}else{position[0]-=np_len;}
too_close=(position[0]+position[2].length)-(text.length-2*np_len);if(too_close>0){position[2]=position[2].substring(0,position[2].length-too_close);}
positions.push(position);}
text=text.substring(nullPadding.length,text.length-nullPadding.length);console.dir([text,results,positions]);return[text,results,positions];};diff_match_patch.prototype.patch_addPadding=function(patches){var paddingLength=this.Patch_Margin;var nullPadding='';for(var x=1;x<=paddingLength;x++){nullPadding+=String.fromCharCode(x);}
for(var x=0;x<patches.length;x++){patches[x].start1+=paddingLength;patches[x].start2+=paddingLength;}
var patch=patches[0];var diffs=patch.diffs;if(diffs.length==0||diffs[0][0]!=DIFF_EQUAL){diffs.unshift([DIFF_EQUAL,nullPadding]);patch.start1-=paddingLength;patch.start2-=paddingLength;patch.length1+=paddingLength;patch.length2+=paddingLength;}else if(paddingLength>diffs[0][1].length){var extraLength=paddingLength-diffs[0][1].length;diffs[0][1]=nullPadding.substring(diffs[0][1].length)+diffs[0][1];patch.start1-=extraLength;patch.start2-=extraLength;patch.length1+=extraLength;patch.length2+=extraLength;}
patch=patches[patches.length-1];diffs=patch.diffs;if(diffs.length==0||diffs[diffs.length-1][0]!=DIFF_EQUAL){diffs.push([DIFF_EQUAL,nullPadding]);patch.length1+=paddingLength;patch.length2+=paddingLength;}else if(paddingLength>diffs[diffs.length-1][1].length){var extraLength=paddingLength-diffs[diffs.length-1][1].length;diffs[diffs.length-1][1]+=nullPadding.substring(0,extraLength);patch.length1+=extraLength;patch.length2+=extraLength;}
return nullPadding;};diff_match_patch.prototype.patch_splitMax=function(patches){var patch_size=this.Match_MaxBits;for(var x=0;x<patches.length;x++){if(patches[x].length1<=patch_size){continue;}
var bigpatch=patches[x];patches.splice(x--,1);var start1=bigpatch.start1;var start2=bigpatch.start2;var precontext='';while(bigpatch.diffs.length!==0){var patch=new diff_match_patch.patch_obj();var empty=true;patch.start1=start1-precontext.length;patch.start2=start2-precontext.length;if(precontext!==''){patch.length1=patch.length2=precontext.length;patch.diffs.push([DIFF_EQUAL,precontext]);}
while(bigpatch.diffs.length!==0&&patch.length1<patch_size-this.Patch_Margin){var diff_type=bigpatch.diffs[0][0];var diff_text=bigpatch.diffs[0][1];if(diff_type===DIFF_INSERT){patch.length2+=diff_text.length;start2+=diff_text.length;patch.diffs.push(bigpatch.diffs.shift());empty=false;}else if(diff_type===DIFF_DELETE&&patch.diffs.length==1&&patch.diffs[0][0]==DIFF_EQUAL&&diff_text.length>2*patch_size){patch.length1+=diff_text.length;start1+=diff_text.length;empty=false;patch.diffs.push([diff_type,diff_text]);bigpatch.diffs.shift();}else{diff_text=diff_text.substring(0,patch_size-patch.length1-this.Patch_Margin);patch.length1+=diff_text.length;start1+=diff_text.length;if(diff_type===DIFF_EQUAL){patch.length2+=diff_text.length;start2+=diff_text.length;}else{empty=false;}
patch.diffs.push([diff_type,diff_text]);if(diff_text==bigpatch.diffs[0][1]){bigpatch.diffs.shift();}else{bigpatch.diffs[0][1]=bigpatch.diffs[0][1].substring(diff_text.length);}}}
precontext=this.diff_text2(patch.diffs);precontext=precontext.substring(precontext.length-this.Patch_Margin);var postcontext=this.diff_text1(bigpatch.diffs).substring(0,this.Patch_Margin);if(postcontext!==''){patch.length1+=postcontext.length;patch.length2+=postcontext.length;if(patch.diffs.length!==0&&patch.diffs[patch.diffs.length-1][0]===DIFF_EQUAL){patch.diffs[patch.diffs.length-1][1]+=postcontext;}else{patch.diffs.push([DIFF_EQUAL,postcontext]);}}
if(!empty){patches.splice(++x,0,patch);}}}};diff_match_patch.prototype.patch_toText=function(patches){var text=[];for(var x=0;x<patches.length;x++){text[x]=patches[x];}
return text.join('');};diff_match_patch.prototype.patch_fromText=function(textline){var patches=[];if(!textline){return patches;}
var text=textline.split('\n');var textPointer=0;var patchHeader=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;while(textPointer<text.length){var m=text[textPointer].match(patchHeader);if(!m){throw new Error('Invalid patch string: '+text[textPointer]);}
var patch=new diff_match_patch.patch_obj();patches.push(patch);patch.start1=parseInt(m[1],10);if(m[2]===''){patch.start1--;patch.length1=1;}else if(m[2]=='0'){patch.length1=0;}else{patch.start1--;patch.length1=parseInt(m[2],10);}
patch.start2=parseInt(m[3],10);if(m[4]===''){patch.start2--;patch.length2=1;}else if(m[4]=='0'){patch.length2=0;}else{patch.start2--;patch.length2=parseInt(m[4],10);}
textPointer++;while(textPointer<text.length){var sign=text[textPointer].charAt(0);try{var line=decodeURI(text[textPointer].substring(1));}catch(ex){throw new Error("Illegal escape in patch_fromText: "+line+" e: "+ex+" text: "+text);}
if(sign=='-'){patch.diffs.push([DIFF_DELETE,line]);}else if(sign=='+'){patch.diffs.push([DIFF_INSERT,line]);}else if(sign==' '){patch.diffs.push([DIFF_EQUAL,line]);}else if(sign=='@'){break;}else if(sign===''){}else{throw new Error('Invalid patch mode "'+sign+'" in: '+line);}
textPointer++;}}
return patches;};diff_match_patch.patch_obj=function(){this.diffs=[];this.start1=null;this.start2=null;this.length1=0;this.length2=0;};diff_match_patch.patch_obj.prototype.toString=function(){var coords1,coords2;if(this.length1===0){coords1=this.start1+',0';}else if(this.length1==1){coords1=this.start1+1;}else{coords1=(this.start1+1)+','+this.length1;}
if(this.length2===0){coords2=this.start2+',0';}else if(this.length2==1){coords2=this.start2+1;}else{coords2=(this.start2+1)+','+this.length2;}
var text=['@@ -'+coords1+' +'+coords2+' @@\n'];var op;for(var x=0;x<this.diffs.length;x++){switch(this.diffs[x][0]){case DIFF_INSERT:op='+';break;case DIFF_DELETE:op='-';break;case DIFF_EQUAL:op=' ';break;}
text[x+1]=op+encodeURI(this.diffs[x][1])+'\n';}
return text.join('').replace(/%20/g,' ');};this['diff_match_patch']=diff_match_patch;this['DIFF_DELETE']=DIFF_DELETE;this['DIFF_INSERT']=DIFF_INSERT;this['DIFF_EQUAL']=DIFF_EQUAL;this['DiffMatchPatch']=diff_match_patch;;(function(){'use strict';var window=this,document=this.document;function EventEmitter(){this._events=this._events||{};}
EventEmitter.prototype.addListener=function(type,listener){this._events[type]=this._events[type]||[];this._events[type].push(listener);};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.removeListener=function(type,listener){if(!this._events[type])return;var obj=this._events[type],i=obj.length;while(i--){if(obj[i]===listener||obj[i].listener===listener){obj.splice(i,1);return;}}};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function(type){if(this._events[type])delete this._events[type];};EventEmitter.prototype.once=function(type,listener){function on(){var args=Array.prototype.slice.call(arguments);this.removeListener(type,on);return listener.apply(this,args);}
on.listener=listener;return this.on(type,on);};EventEmitter.prototype.emit=function(type){if(!this._events[type])return;var args=Array.prototype.slice.call(arguments,1),obj=this._events[type],l=obj.length,i=0;for(;i<l;i++){obj[i].apply(this,args);}};EventEmitter.prototype.listeners=function(type){return this._events[type]=this._events[type]||[];};var normal=0,escaped=1,csi=2,osc=3,charset=4,dcs=5,ignore=6;function Terminal(options){var self=this;if(!(this instanceof Terminal)){return new Terminal(arguments[0],arguments[1],arguments[2]);}
EventEmitter.call(this);if(typeof options==='number'){options={cols:arguments[0],rows:arguments[1],handler:arguments[2]};}
options=options||{};each(keys(Terminal.defaults),function(key){if(options[key]==null){options[key]=Terminal.options[key];if(Terminal[key]!==Terminal.defaults[key]){options[key]=Terminal[key];}}
self[key]=options[key];});if(options.colors.length===8){options.colors=options.colors.concat(Terminal._colors.slice(8));}else if(options.colors.length===16){options.colors=options.colors.concat(Terminal._colors.slice(16));}else if(options.colors.length===10){options.colors=options.colors.slice(0,-2).concat(Terminal._colors.slice(8,-2),options.colors.slice(-2));}else if(options.colors.length===18){options.colors=options.colors.slice(0,-2).concat(Terminal._colors.slice(16,-2),options.colors.slice(-2));}
this.colors=options.colors;this.options=options;this.parent=options.body||options.parent||(document?document.getElementsByTagName('body')[0]:null);this.cols=options.cols||options.geometry[0];this.rows=options.rows||options.geometry[1];if(options.handler){this.off('data',options.handler);this.on('data',options.handler);}
this.ybase=0;this.ydisp=0;this.x=0;this.y=0;this.cursorState=0;this.cursorHidden=false;this.convertEol;this.state=0;this.queue='';this.scrollTop=0;this.scrollBottom=this.rows-1;this.applicationKeypad=false;this.applicationCursor=false;this.originMode=false;this.insertMode=false;this.wraparoundMode=false;this.normal=null;this.prefixMode=false;this.selectMode=false;this.visualMode=false;this.searchMode=false;this.searchDown;this.entry='';this.entryPrefix='Search: ';this._real;this._selected;this._textarea;this.charset=null;this.gcharset=null;this.glevel=0;this.charsets=[null];this.decLocator;this.x10Mouse;this.vt200Mouse;this.vt300Mouse;this.normalMouse;this.mouseEvents;this.sendFocus;this.utfMouse;this.sgrMouse;this.urxvtMouse;this.element;this.children;this.refreshStart;this.refreshEnd;this.savedX;this.savedY;this.savedCols;this.readable=true;this.writable=true;this.defAttr=(0<<18)|(257<<9)|(256<<0);this.curAttr=this.defAttr;this.params=[];this.currentParam=0;this.prefix='';this.postfix='';this.lines=[];var i=this.rows;while(i--){this.lines.push(this.blankLine());}
this.tabs;this.setupStops();}
inherits(Terminal,EventEmitter);Terminal.prototype.eraseAttr=function(){return(this.defAttr&~0x1ff)|(this.curAttr&0x1ff);};Terminal.tangoColors=['#2e3436','#cc0000','#4e9a06','#c4a000','#3465a4','#75507b','#06989a','#d3d7cf','#555753','#ef2929','#8ae234','#fce94f','#729fcf','#ad7fa8','#34e2e2','#eeeeec'];Terminal.xtermColors=['#000000','#cd0000','#00cd00','#cdcd00','#0000ee','#cd00cd','#00cdcd','#e5e5e5','#7f7f7f','#ff0000','#00ff00','#ffff00','#5c5cff','#ff00ff','#00ffff','#ffffff'];Terminal.colors=(function(){var colors=Terminal.tangoColors.slice(),r=[0x00,0x5f,0x87,0xaf,0xd7,0xff],i;i=0;for(;i<216;i++){out(r[(i/36)%6|0],r[(i/6)%6|0],r[i%6]);}
i=0;for(;i<24;i++){r=8+i*10;out(r,r,r);}
function out(r,g,b){colors.push('#'+hex(r)+hex(g)+hex(b));}
function hex(c){c=c.toString(16);return c.length<2?'0'+c:c;}
return colors;})();Terminal.colors[256]='#000000';Terminal.colors[257]='#f0f0f0';Terminal._colors=Terminal.colors.slice();Terminal.vcolors=(function(){var out=[],colors=Terminal.colors,i=0,color;for(;i<256;i++){color=parseInt(colors[i].substring(1),16);out.push([(color>>16)&0xff,(color>>8)&0xff,color&0xff]);}
return out;})();Terminal.defaults={colors:Terminal.colors,convertEol:false,termName:'xterm',geometry:[40,24],cursorBlink:true,visualBell:false,popOnBell:false,scrollback:1000,screenKeys:false,debug:false,useStyle:false};Terminal.options={};each(keys(Terminal.defaults),function(key){Terminal[key]=Terminal.defaults[key];Terminal.options[key]=Terminal.defaults[key];});Terminal.focus=null;Terminal.prototype.focus=function(){if(Terminal.focus===this)return;if(Terminal.focus){Terminal.focus.blur();}
if(this.sendFocus)this.send('\x1b[I');this.showCursor();Terminal.focus=this;};Terminal.prototype.blur=function(){if(Terminal.focus!==this)return;this.cursorState=0;this.refresh(this.y,this.y);if(this.sendFocus)this.send('\x1b[O');Terminal.focus=null;};Terminal.prototype.initGlobal=function(){var document=this.document;Terminal._boundDocs=Terminal._boundDocs||[];if(~indexOf(Terminal._boundDocs,document)){return;}
Terminal._boundDocs.push(document);Terminal.bindPaste(document);Terminal.bindKeys(document);Terminal.bindCopy(document);if(this.isIpad||this.isIphone){Terminal.fixIpad(document);}
if(this.useStyle){Terminal.insertStyle(document,this.colors[256],this.colors[257]);}};Terminal.bindPaste=function(document){var window=document.defaultView;on(window,'paste',function(ev){var term=Terminal.focus;if(!term)return;if(ev.clipboardData){term.send(ev.clipboardData.getData('text/plain'));}else if(term.context.clipboardData){term.send(term.context.clipboardData.getData('Text'));}
term.element.contentEditable='inherit';return cancel(ev);});};Terminal.bindKeys=function(document){on(document,'keydown',function(ev){if(!Terminal.focus)return;var target=ev.target||ev.srcElement;if(!target)return;if(target===Terminal.focus.element||target===Terminal.focus.context||target===Terminal.focus.document||target===Terminal.focus.body||target===Terminal._textarea||target===Terminal.focus.parent){return Terminal.focus.keyDown(ev);}},true);on(document,'keypress',function(ev){if(!Terminal.focus)return;var target=ev.target||ev.srcElement;if(!target)return;if(target===Terminal.focus.element||target===Terminal.focus.context||target===Terminal.focus.document||target===Terminal.focus.body||target===Terminal._textarea||target===Terminal.focus.parent){return Terminal.focus.keyPress(ev);}},true);on(document,'mousedown',function(ev){if(!Terminal.focus)return;var el=ev.target||ev.srcElement;if(!el)return;do{if(el===Terminal.focus.element)return;}while(el=el.parentNode);Terminal.focus.blur();});};Terminal.bindCopy=function(document){var window=document.defaultView;on(window,'copy',function(ev){var term=Terminal.focus;if(!term)return;if(!term._selected)return;var textarea=term.getCopyTextarea();var text=term.grabText(term._selected.x1,term._selected.x2,term._selected.y1,term._selected.y2);term.emit('copy',text);textarea.focus();textarea.textContent=text;textarea.value=text;textarea.setSelectionRange(0,text.length);setTimeout(function(){term.element.focus();term.focus();},1);});};Terminal.fixIpad=function(document){var textarea=document.createElement('textarea');textarea.style.position='absolute';textarea.style.left='-32000px';textarea.style.top='-32000px';textarea.style.width='0px';textarea.style.height='0px';textarea.style.opacity='0';textarea.style.backgroundColor='transparent';textarea.style.borderStyle='none';textarea.style.outlineStyle='none';textarea.autocapitalize='none';textarea.autocorrect='off';document.getElementsByTagName('body')[0].appendChild(textarea);Terminal._textarea=textarea;setTimeout(function(){textarea.focus();},1000);};Terminal.insertStyle=function(document,bg,fg){var style=document.getElementById('term-style');if(style)return;var head=document.getElementsByTagName('head')[0];if(!head)return;var style=document.createElement('style');style.id='term-style';style.innerHTML=''
+'.terminal {\n'
+'  float: left;\n'
+'  border: '+bg+' solid 5px;\n'
+'  font-family: "DejaVu Sans Mono", "Liberation Mono", monospace;\n'
+'  font-size: 11px;\n'
+'  color: '+fg+';\n'
+'  background: '+bg+';\n'
+'}\n'
+'\n'
+'.terminal-cursor {\n'
+'  color: '+bg+';\n'
+'  background: '+fg+';\n'
+'}\n';head.insertBefore(style,head.firstChild);};Terminal.prototype.open=function(parent){var self=this,i=0,div;this.parent=parent||this.parent;if(!this.parent){throw new Error('Terminal requires a parent element.');}
this.context=this.parent.ownerDocument.defaultView;this.document=this.parent.ownerDocument;this.body=this.document.getElementsByTagName('body')[0];if(this.context.navigator&&this.context.navigator.userAgent){this.isMac=!!~this.context.navigator.userAgent.indexOf('Mac');this.isIpad=!!~this.context.navigator.userAgent.indexOf('iPad');this.isIphone=!!~this.context.navigator.userAgent.indexOf('iPhone');this.isMSIE=!!~this.context.navigator.userAgent.indexOf('MSIE');}
this.element=this.document.createElement('div');this.element.className='terminal';this.element.style.outline='none';this.element.setAttribute('tabindex',0);this.element.setAttribute('spellcheck','false');this.element.style.backgroundColor=this.colors[256];this.element.style.color=this.colors[257];this.children=[];for(;i<this.rows;i++){div=this.document.createElement('div');this.element.appendChild(div);this.children.push(div);}
this.parent.appendChild(this.element);this.refresh(0,this.rows-1);this.initGlobal();this.focus();this.startBlink();on(this.element,'focus',function(){self.focus();if(self.isIpad||self.isIphone){Terminal._textarea.focus();}});on(this.element,'mousedown',function(){self.focus();});on(this.element,'mousedown',function(ev){var button=ev.button!=null?+ev.button:ev.which!=null?ev.which-1:null;if(self.isMSIE){button=button===1?0:button===4?1:button;}
if(button!==2)return;self.element.contentEditable='true';setTimeout(function(){self.element.contentEditable='inherit';},1);},true);this.bindMouse();if(Terminal.brokenBold==null){Terminal.brokenBold=isBoldBroken(this.document);}
setTimeout(function(){self.element.focus();},100);};Terminal.prototype.bindMouse=function(){var el=this.element,self=this,pressed=32;var wheelEvent='onmousewheel'in this.context?'mousewheel':'DOMMouseScroll';function sendButton(ev){var button,pos;button=getButton(ev);pos=getCoords(ev);if(!pos)return;sendEvent(button,pos);switch(ev.type){case'mousedown':pressed=button;break;case'mouseup':pressed=32;break;case wheelEvent:break;}}
function sendMove(ev){var button=pressed,pos;pos=getCoords(ev);if(!pos)return;button+=32;sendEvent(button,pos);}
function encode(data,ch){if(!self.utfMouse){if(ch===255)return data.push(0);if(ch>127)ch=127;data.push(ch);}else{if(ch===2047)return data.push(0);if(ch<127){data.push(ch);}else{if(ch>2047)ch=2047;data.push(0xC0|(ch>>6));data.push(0x80|(ch&0x3F));}}}
function sendEvent(button,pos){if(self.vt300Mouse){button&=3;pos.x-=32;pos.y-=32;var data='\x1b[24';if(button===0)data+='1';else if(button===1)data+='3';else if(button===2)data+='5';else if(button===3)return;else data+='0';data+='~['+pos.x+','+pos.y+']\r';self.send(data);return;}
if(self.decLocator){button&=3;pos.x-=32;pos.y-=32;if(button===0)button=2;else if(button===1)button=4;else if(button===2)button=6;else if(button===3)button=3;self.send('\x1b['
+button
+';'
+(button===3?4:0)
+';'
+pos.y
+';'
+pos.x
+';'
+(pos.page||0)
+'&w');return;}
if(self.urxvtMouse){pos.x-=32;pos.y-=32;pos.x++;pos.y++;self.send('\x1b['+button+';'+pos.x+';'+pos.y+'M');return;}
if(self.sgrMouse){pos.x-=32;pos.y-=32;self.send('\x1b[<'
+((button&3)===3?button&~3:button)
+';'
+pos.x
+';'
+pos.y
+((button&3)===3?'m':'M'));return;}
var data=[];encode(data,button);encode(data,pos.x);encode(data,pos.y);self.send('\x1b[M'+String.fromCharCode.apply(String,data));}
function getButton(ev){var button,shift,meta,ctrl,mod;switch(ev.type){case'mousedown':button=ev.button!=null?+ev.button:ev.which!=null?ev.which-1:null;if(self.isMSIE){button=button===1?0:button===4?1:button;}
break;case'mouseup':button=3;break;case'DOMMouseScroll':button=ev.detail<0?64:65;break;case'mousewheel':button=ev.wheelDeltaY>0?64:65;break;}
shift=ev.shiftKey?4:0;meta=ev.metaKey?8:0;ctrl=ev.ctrlKey?16:0;mod=shift|meta|ctrl;if(self.vt200Mouse){mod&=ctrl;}else if(!self.normalMouse){mod=0;}
button=(32+(mod<<2))+button;return button;}
function getCoords(ev){var x,y,w,h,el;if(ev.pageX==null)return;x=ev.pageX;y=ev.pageY;el=self.element;while(el&&el!==self.document.documentElement){x-=el.offsetLeft;y-=el.offsetTop;el='offsetParent'in el?el.offsetParent:el.parentNode;}
w=self.element.clientWidth;h=self.element.clientHeight;x=Math.round((x/w)*self.cols);y=Math.round((y/h)*self.rows);if(x<0)x=0;if(x>self.cols)x=self.cols;if(y<0)y=0;if(y>self.rows)y=self.rows;x+=32;y+=32;return{x:x,y:y,type:ev.type===wheelEvent?'mousewheel':ev.type};}
on(el,'mousedown',function(ev){if(!self.mouseEvents)return;sendButton(ev);self.focus();if(self.vt200Mouse){var syntheticEvent={};for(var key in event){syntheticEvent[key]=event[key]}
syntheticEvent.type='mouseup';sendButton(syntheticEvent);return cancel(ev);}
if(self.normalMouse)on(self.document,'mousemove',sendMove);if(!self.x10Mouse){on(self.document,'mouseup',function up(ev){sendButton(ev);if(self.normalMouse)off(self.document,'mousemove',sendMove);off(self.document,'mouseup',up);return cancel(ev);});}
return cancel(ev);});on(el,wheelEvent,function(ev){if(!self.mouseEvents)return;if(self.x10Mouse||self.vt300Mouse||self.decLocator)return;sendButton(ev);return cancel(ev);});on(el,wheelEvent,function(ev){if(self.mouseEvents)return;if(self.applicationKeypad)return;if(ev.type==='DOMMouseScroll'){self.scrollDisp(ev.detail<0?-5:5);}else{self.scrollDisp(ev.wheelDeltaY>0?-5:5);}
return cancel(ev);});};Terminal.prototype.destroy=function(){this.readable=false;this.writable=false;this._events={};this.handler=function(){};this.write=function(){};if(this.element.parentNode){this.element.parentNode.removeChild(this.element);}};Terminal.prototype.refresh=function(start,end){var x,y,i,line,out,ch,width,data,attr,bg,fg,flags,row,parent;if(end-start>=this.rows/2){parent=this.element.parentNode;if(parent)parent.removeChild(this.element);}
width=this.cols;y=start;if(end>=this.lines.length){this.log('`end` is too large. Most likely a bad CSR.');end=this.lines.length-1;}
for(;y<=end;y++){row=y+this.ydisp;line=this.lines[row];out='';if(y===this.y&&this.cursorState&&(this.ydisp===this.ybase||this.selectMode)&&!this.cursorHidden){x=this.x;}else{x=-1;}
attr=this.defAttr;i=0;for(;i<width;i++){data=line[i][0];ch=line[i][1];if(i===x)data=-1;if(data!==attr){if(attr!==this.defAttr){out+='</span>';}
if(data!==this.defAttr){if(data===-1){out+='<span class="reverse-video terminal-cursor">';}else{out+='<span style="';bg=data&0x1ff;fg=(data>>9)&0x1ff;flags=data>>18;if(flags&1){if(!Terminal.brokenBold){out+='font-weight:bold;';}
if(fg<8)fg+=8;}
if(flags&2){out+='text-decoration:underline;';}
if(flags&4){if(flags&2){out=out.slice(0,-1);out+=' blink;';}else{out+='text-decoration:blink;';}}
if(flags&8){bg=(data>>9)&0x1ff;fg=data&0x1ff;if((flags&1)&&fg<8)fg+=8;}
if(flags&16){out+='visibility:hidden;';}
if(bg!==256){out+='background-color:'
+this.colors[bg]
+';';}
if(fg!==257){out+='color:'
+this.colors[fg]
+';';}
out+='">';}}}
switch(ch){case'&':out+='&amp;';break;case'<':out+='&lt;';break;case'>':out+='&gt;';break;default:if(ch<=' '){out+='&nbsp;';}else{if(isWide(ch))i++;out+=ch;}
break;}
attr=data;}
if(attr!==this.defAttr){out+='</span>';}
if(this.children[y]){this.children[y].innerHTML=out;}}
if(parent)parent.appendChild(this.element);};Terminal.prototype._cursorBlink=function(){if(Terminal.focus!==this)return;this.cursorState^=1;this.refresh(this.y,this.y);};Terminal.prototype.showCursor=function(){if(!this.cursorState){this.cursorState=1;this.refresh(this.y,this.y);}else{}};Terminal.prototype.startBlink=function(){if(!this.cursorBlink)return;var self=this;this._blinker=function(){self._cursorBlink();};this._blink=setInterval(this._blinker,500);};Terminal.prototype.refreshBlink=function(){if(!this.cursorBlink)return;clearInterval(this._blink);this._blink=setInterval(this._blinker,500);};Terminal.prototype.clear=function(){this.lines.splice(0,this.ybase+this.y);this.lines.splice(1,this.lines.length-1);while(this.lines.length<this.rows){this.lines.push(this.blankLine());}
this.y=0;this.ybase=0;this.ydisp=0;this.refresh(0,this.rows-1);}
Terminal.prototype.scroll=function(){var row;if(++this.ybase===this.scrollback){this.ybase=this.ybase/2|0;this.lines=this.lines.slice(-(this.ybase+this.rows)+1);}
this.ydisp=this.ybase;row=this.ybase+this.rows-1;row-=this.rows-1-this.scrollBottom;if(row===this.lines.length){this.lines.push(this.blankLine());}else{this.lines.splice(row,0,this.blankLine());}
if(this.scrollTop!==0){if(this.ybase!==0){this.ybase--;this.ydisp=this.ybase;}
this.lines.splice(this.ybase+this.scrollTop,1);}
this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom);};Terminal.prototype.scrollDisp=function(disp){this.ydisp+=disp;if(this.ydisp>this.ybase){this.ydisp=this.ybase;}else if(this.ydisp<0){this.ydisp=0;}
this.refresh(0,this.rows-1);};Terminal.prototype.write=function(data){var l=data.length,i=0,j,cs,ch;this.refreshStart=this.y;this.refreshEnd=this.y;if(this.ybase!==this.ydisp){this.ydisp=this.ybase;this.maxRange();}
for(;i<l;i++){ch=data[i];switch(this.state){case normal:switch(ch){case'\x07':this.bell();break;case'\n':case'\x0b':case'\x0c':if(this.convertEol){this.x=0;}
this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll();}
break;case'\r':this.x=0;break;case'\x08':if(this.x>0){this.x--;}
break;case'\t':this.x=this.nextStop();break;case'\x0e':this.setgLevel(1);break;case'\x0f':this.setgLevel(0);break;case'\x1b':this.state=escaped;break;default:if(ch>=' '){if(this.charset&&this.charset[ch]){ch=this.charset[ch];}
if(this.x>=this.cols){this.x=0;this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll();}}
this.lines[this.y+this.ybase][this.x]=[this.curAttr,ch];this.x++;this.updateRange(this.y);if(isWide(ch)){j=this.y+this.ybase;if(this.cols<2||this.x>=this.cols){this.lines[j][this.x-1]=[this.curAttr,' '];break;}
this.lines[j][this.x]=[this.curAttr,' '];this.x++;}}
break;}
break;case escaped:switch(ch){case'[':this.params=[];this.currentParam=0;this.state=csi;break;case']':this.params=[];this.currentParam=0;this.state=osc;break;case'P':this.params=[];this.currentParam=0;this.state=dcs;break;case'_':this.state=ignore;break;case'^':this.state=ignore;break;case'c':this.reset();break;case'E':this.x=0;;case'D':this.index();break;case'M':this.reverseIndex();break;case'%':this.setgLevel(0);this.setgCharset(0,Terminal.charsets.US);this.state=normal;i++;break;case'(':case')':case'*':case'+':case'-':case'.':switch(ch){case'(':this.gcharset=0;break;case')':this.gcharset=1;break;case'*':this.gcharset=2;break;case'+':this.gcharset=3;break;case'-':this.gcharset=1;break;case'.':this.gcharset=2;break;}
this.state=charset;break;case'/':this.gcharset=3;this.state=charset;i--;break;case'N':break;case'O':break;case'n':this.setgLevel(2);break;case'o':this.setgLevel(3);break;case'|':this.setgLevel(3);break;case'}':this.setgLevel(2);break;case'~':this.setgLevel(1);break;case'7':this.saveCursor();this.state=normal;break;case'8':this.restoreCursor();this.state=normal;break;case'#':this.state=normal;i++;break;case'H':this.tabSet();break;case'=':this.log('Serial port requested application keypad.');this.applicationKeypad=true;this.state=normal;break;case'>':this.log('Switching back to normal keypad.');this.applicationKeypad=false;this.state=normal;break;default:this.state=normal;this.error('Unknown ESC control: %s.',ch);break;}
break;case charset:switch(ch){case'0':cs=Terminal.charsets.SCLD;break;case'A':cs=Terminal.charsets.UK;break;case'B':cs=Terminal.charsets.US;break;case'4':cs=Terminal.charsets.Dutch;break;case'C':case'5':cs=Terminal.charsets.Finnish;break;case'R':cs=Terminal.charsets.French;break;case'Q':cs=Terminal.charsets.FrenchCanadian;break;case'K':cs=Terminal.charsets.German;break;case'Y':cs=Terminal.charsets.Italian;break;case'E':case'6':cs=Terminal.charsets.NorwegianDanish;break;case'Z':cs=Terminal.charsets.Spanish;break;case'H':case'7':cs=Terminal.charsets.Swedish;break;case'=':cs=Terminal.charsets.Swiss;break;case'/':cs=Terminal.charsets.ISOLatin;i++;break;default:cs=Terminal.charsets.US;break;}
this.setgCharset(this.gcharset,cs);this.gcharset=null;this.state=normal;break;case osc:if(ch==='\x1b'||ch==='\x07'){if(ch==='\x1b')i++;this.params.push(this.currentParam);switch(this.params[0]){case 0:case 1:case 2:if(this.params[1]){this.title=this.params[1];this.handleTitle(this.title);}
break;case 3:break;case 4:case 5:break;case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:break;case 46:break;case 50:break;case 51:break;case 52:break;case 104:case 105:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:break;}
this.params=[];this.currentParam=0;this.state=normal;}else{if(!this.params.length){if(ch>='0'&&ch<='9'){this.currentParam=this.currentParam*10+ch.charCodeAt(0)-48;}else if(ch===';'){this.params.push(this.currentParam);this.currentParam='';}}else{this.currentParam+=ch;}}
break;case csi:if(ch==='?'||ch==='>'||ch==='!'){this.prefix=ch;break;}
if(ch>='0'&&ch<='9'){this.currentParam=this.currentParam*10+ch.charCodeAt(0)-48;break;}
if(ch==='$'||ch==='"'||ch===' '||ch==='\''){this.postfix=ch;break;}
this.params.push(this.currentParam);this.currentParam=0;if(ch===';')break;this.state=normal;switch(ch){case'A':this.cursorUp(this.params);break;case'B':this.cursorDown(this.params);break;case'C':this.cursorForward(this.params);break;case'D':this.cursorBackward(this.params);break;case'H':this.cursorPos(this.params);break;case'J':this.eraseInDisplay(this.params);break;case'K':this.eraseInLine(this.params);break;case'm':if(!this.prefix){this.charAttributes(this.params);}
break;case'n':if(!this.prefix){this.deviceStatus(this.params);}
break;case'@':this.insertChars(this.params);break;case'E':this.cursorNextLine(this.params);break;case'F':this.cursorPrecedingLine(this.params);break;case'G':this.cursorCharAbsolute(this.params);break;case'L':this.insertLines(this.params);break;case'M':this.deleteLines(this.params);break;case'P':this.deleteChars(this.params);break;case'X':this.eraseChars(this.params);break;case'`':this.charPosAbsolute(this.params);break;case'a':this.HPositionRelative(this.params);break;case'c':this.sendDeviceAttributes(this.params);break;case'd':this.linePosAbsolute(this.params);break;case'e':this.VPositionRelative(this.params);break;case'f':this.HVPosition(this.params);break;case'h':this.setMode(this.params);break;case'l':this.resetMode(this.params);break;case'r':this.setScrollRegion(this.params);break;case's':this.saveCursor(this.params);break;case'u':this.restoreCursor(this.params);break;case'I':this.cursorForwardTab(this.params);break;case'S':this.scrollUp(this.params);break;case'T':if(this.params.length<2&&!this.prefix){this.scrollDown(this.params);}
break;case'Z':this.cursorBackwardTab(this.params);break;case'b':this.repeatPrecedingCharacter(this.params);break;case'g':this.tabClear(this.params);break;case'p':switch(this.prefix){case'!':this.softReset(this.params);break;}
break;default:this.error('Unknown CSI code: %s.',ch);break;}
this.prefix='';this.postfix='';break;case dcs:if(ch==='\x1b'||ch==='\x07'){if(ch==='\x1b')i++;switch(this.prefix){case'':break;case'$q':var pt=this.currentParam,valid=false;switch(pt){case'"q':pt='0"q';break;case'"p':pt='61"p';break;case'r':pt=''
+(this.scrollTop+1)
+';'
+(this.scrollBottom+1)
+'r';break;case'm':pt='0m';break;default:this.error('Unknown DCS Pt: %s.',pt);pt='';break;}
this.send('\x1bP'+ +valid+'$r'+pt+'\x1b\\');break;case'+p':break;case'+q':var pt=this.currentParam,valid=false;this.send('\x1bP'+ +valid+'+r'+pt+'\x1b\\');break;default:this.error('Unknown DCS prefix: %s.',this.prefix);break;}
this.currentParam=0;this.prefix='';this.state=normal;}else if(!this.currentParam){if(!this.prefix&&ch!=='$'&&ch!=='+'){this.currentParam=ch;}else if(this.prefix.length===2){this.currentParam=ch;}else{this.prefix+=ch;}}else{this.currentParam+=ch;}
break;case ignore:if(ch==='\x1b'||ch==='\x07'){if(ch==='\x1b')i++;this.state=normal;}
break;}}
this.updateRange(this.y);this.refresh(this.refreshStart,this.refreshEnd);};Terminal.prototype.writeln=function(data){this.write(data+'\r\n');};Terminal.prototype.keyDown=function(ev){var self=this,key;switch(ev.keyCode){case 8:if(ev.shiftKey){key='\x08';break;}
key='\x7f';break;case 9:if(ev.shiftKey){key='\x1b[Z';break;}
key='\t';break;case 13:key='\r';break;case 27:key='\x1b';break;case 37:if(this.applicationCursor){key='\x1bOD';break;}
key='\x1b[D';break;case 39:if(this.applicationCursor){key='\x1bOC';break;}
key='\x1b[C';break;case 38:if(this.applicationCursor){key='\x1bOA';break;}
if(ev.ctrlKey){this.scrollDisp(-1);return cancel(ev);}else{key='\x1b[A';}
break;case 40:if(this.applicationCursor){key='\x1bOB';break;}
if(ev.ctrlKey){this.scrollDisp(1);return cancel(ev);}else{key='\x1b[B';}
break;case 46:key='\x1b[3~';break;case 45:key='\x1b[2~';break;case 36:if(this.applicationKeypad){key='\x1bOH';break;}
key='\x1bOH';break;case 35:if(this.applicationKeypad){key='\x1bOF';break;}
key='\x1bOF';break;case 33:if(ev.shiftKey){this.scrollDisp(-(this.rows-1));return cancel(ev);}else{key='\x1b[5~';}
break;case 34:if(ev.shiftKey){this.scrollDisp(this.rows-1);return cancel(ev);}else{key='\x1b[6~';}
break;case 112:key='\x1bOP';break;case 113:key='\x1bOQ';break;case 114:key='\x1bOR';break;case 115:key='\x1bOS';break;case 116:key='\x1b[15~';break;case 117:key='\x1b[17~';break;case 118:key='\x1b[18~';break;case 119:key='\x1b[19~';break;case 120:key='\x1b[20~';break;case 121:key='\x1b[21~';break;case 122:key='\x1b[23~';break;case 123:key='\x1b[24~';break;case 75:if((!this.isMac&&ev.ctrlKey)||(this.isMac&&ev.metaKey)){this.clear();return cancel(ev);}
default:if(ev.ctrlKey){if(ev.keyCode>=65&&ev.keyCode<=90){if(this.screenKeys){if(!this.prefixMode&&!this.selectMode&&ev.keyCode===65){this.enterPrefix();return cancel(ev);}}
if(this.prefixMode&&ev.keyCode===86){this.leavePrefix();return;}
if((this.prefixMode||this.selectMode)&&ev.keyCode===67){if(this.visualMode){setTimeout(function(){self.leaveVisual();},1);}
return;}
key=String.fromCharCode(ev.keyCode-64);}else if(ev.keyCode===32){key=String.fromCharCode(0);}else if(ev.keyCode>=51&&ev.keyCode<=55){key=String.fromCharCode(ev.keyCode-51+27);}else if(ev.keyCode===56){key=String.fromCharCode(127);}else if(ev.keyCode===219){key=String.fromCharCode(27);}else if(ev.keyCode===221){key=String.fromCharCode(29);}}else if((!this.isMac&&ev.altKey)||(this.isMac&&ev.metaKey)){if(ev.keyCode>=65&&ev.keyCode<=90){key='\x1b'+String.fromCharCode(ev.keyCode+32);}else if(ev.keyCode===192){key='\x1b`';}else if(ev.keyCode>=48&&ev.keyCode<=57){key='\x1b'+(ev.keyCode-48);}}
break;}
if(!key)return true;if(this.prefixMode){this.leavePrefix();return cancel(ev);}
if(this.selectMode){this.keySelect(ev,key);return cancel(ev);}
this.emit('keydown',ev);this.emit('key',key,ev);this.showCursor();this.handler(key);return cancel(ev);};Terminal.prototype.setgLevel=function(g){this.glevel=g;this.charset=this.charsets[g];};Terminal.prototype.setgCharset=function(g,charset){this.charsets[g]=charset;if(this.glevel===g){this.charset=charset;}};Terminal.prototype.keyPress=function(ev){var key;if(ev.charCode){key=ev.charCode;}else if(ev.which==null){key=ev.keyCode;}else if(ev.which!==0&&ev.charCode!==0){key=ev.which;}else{return false;}
key=String.fromCharCode(key);if(this.prefixMode){this.leavePrefix();this.keyPrefix(ev,key);return false;}
if(this.selectMode){this.keySelect(ev,key);return false;}
this.emit('keypress',key,ev);this.emit('key',key,ev);this.showCursor();this.handler(key);return false;};Terminal.prototype.send=function(data){var self=this;if(!this.queue){setTimeout(function(){self.handler(self.queue);self.queue='';},1);}
this.queue+=data;};Terminal.prototype.bell=function(){this.emit('bell');if(!this.visualBell)return;var self=this;this.element.style.borderColor='white';setTimeout(function(){self.element.style.borderColor='';},10);if(this.popOnBell)this.focus();};Terminal.prototype.log=function(){if(!this.debug)return;if(!this.context.console||!this.context.console.log)return;var args=Array.prototype.slice.call(arguments);this.context.console.log.apply(this.context.console,args);};Terminal.prototype.error=function(){if(!this.debug)return;if(!this.context.console||!this.context.console.error)return;var args=Array.prototype.slice.call(arguments);this.context.console.error.apply(this.context.console,args);};Terminal.prototype.resize=function(x,y){var line,el,i,j,ch;if(x<1)x=1;if(y<1)y=1;j=this.cols;if(j<x){ch=[this.defAttr,' '];i=this.lines.length;while(i--){while(this.lines[i].length<x){this.lines[i].push(ch);}}}else if(j>x){i=this.lines.length;while(i--){while(this.lines[i].length>x){this.lines[i].pop();}}}
this.setupStops(j);this.cols=x;j=this.rows;if(j<y){el=this.element;while(j++<y){if(this.lines.length<y+this.ybase){this.lines.push(this.blankLine());}
if(this.children.length<y){line=this.document.createElement('div');el.appendChild(line);this.children.push(line);}}}else if(j>y){while(j-->y){if(this.lines.length>y+this.ybase){this.lines.pop();}
if(this.children.length>y){el=this.children.pop();if(!el)continue;el.parentNode.removeChild(el);}}}
this.rows=y;if(this.y>=y)this.y=y-1;if(this.x>=x)this.x=x-1;this.scrollTop=0;this.scrollBottom=y-1;this.refresh(0,this.rows-1);this.normal=null;};Terminal.prototype.updateRange=function(y){if(y<this.refreshStart)this.refreshStart=y;if(y>this.refreshEnd)this.refreshEnd=y;};Terminal.prototype.maxRange=function(){this.refreshStart=0;this.refreshEnd=this.rows-1;};Terminal.prototype.setupStops=function(i){if(i!=null){if(!this.tabs[i]){i=this.prevStop(i);}}else{this.tabs={};i=0;}
for(;i<this.cols;i+=8){this.tabs[i]=true;}};Terminal.prototype.prevStop=function(x){if(x==null)x=this.x;while(!this.tabs[--x]&&x>0);return x>=this.cols?this.cols-1:x<0?0:x;};Terminal.prototype.nextStop=function(x){if(x==null)x=this.x;while(!this.tabs[++x]&&x<this.cols);return x>=this.cols?this.cols-1:x<0?0:x;};Terminal.prototype.eraseRight=function(x,y){var line=this.lines[this.ybase+y],ch=[this.eraseAttr(),' '];for(;x<this.cols;x++){line[x]=ch;}
this.updateRange(y);};Terminal.prototype.eraseLeft=function(x,y){var line=this.lines[this.ybase+y],ch=[this.eraseAttr(),' '];x++;while(x--)line[x]=ch;this.updateRange(y);};Terminal.prototype.eraseLine=function(y){this.eraseRight(0,y);};Terminal.prototype.blankLine=function(cur){var attr=cur?this.eraseAttr():this.defAttr;var ch=[attr,' '],line=[],i=0;for(;i<this.cols;i++){line[i]=ch;}
return line;};Terminal.prototype.ch=function(cur){return cur?[this.eraseAttr(),' ']:[this.defAttr,' '];};Terminal.prototype.is=function(term){var name=this.termName;return(name+'').indexOf(term)===0;};Terminal.prototype.handler=function(data){this.emit('data',data);};Terminal.prototype.handleTitle=function(title){this.emit('title',title);};Terminal.prototype.index=function(){this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll();}
this.state=normal;};Terminal.prototype.reverseIndex=function(){var j;this.y--;if(this.y<this.scrollTop){this.y++;this.lines.splice(this.y+this.ybase,0,this.blankLine(true));j=this.rows-1-this.scrollBottom;this.lines.splice(this.rows-1+this.ybase-j+1,1);this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom);}
this.state=normal;};Terminal.prototype.reset=function(){this.options.rows=this.rows;this.options.cols=this.cols;Terminal.call(this,this.options);this.refresh(0,this.rows-1);};Terminal.prototype.tabSet=function(){this.tabs[this.x]=true;this.state=normal;};Terminal.prototype.cursorUp=function(params){var param=params[0];if(param<1)param=1;this.y-=param;if(this.y<0)this.y=0;};Terminal.prototype.cursorDown=function(params){var param=params[0];if(param<1)param=1;this.y+=param;if(this.y>=this.rows){this.y=this.rows-1;}};Terminal.prototype.cursorForward=function(params){var param=params[0];if(param<1)param=1;this.x+=param;if(this.x>=this.cols){this.x=this.cols-1;}};Terminal.prototype.cursorBackward=function(params){var param=params[0];if(param<1)param=1;this.x-=param;if(this.x<0)this.x=0;};Terminal.prototype.cursorPos=function(params){var row,col;row=params[0]-1;if(params.length>=2){col=params[1]-1;}else{col=0;}
if(row<0){row=0;}else if(row>=this.rows){row=this.rows-1;}
if(col<0){col=0;}else if(col>=this.cols){col=this.cols-1;}
this.x=col;this.y=row;};Terminal.prototype.eraseInDisplay=function(params){var j;switch(params[0]){case 0:this.eraseRight(this.x,this.y);j=this.y+1;for(;j<this.rows;j++){this.eraseLine(j);}
break;case 1:this.eraseLeft(this.x,this.y);j=this.y;while(j--){this.eraseLine(j);}
break;case 2:j=this.rows;while(j--)this.eraseLine(j);break;case 3:;break;}};Terminal.prototype.eraseInLine=function(params){switch(params[0]){case 0:this.eraseRight(this.x,this.y);break;case 1:this.eraseLeft(this.x,this.y);break;case 2:this.eraseLine(this.y);break;}};Terminal.prototype.charAttributes=function(params){if(params.length===1&&params[0]===0){this.curAttr=this.defAttr;return;}
var l=params.length,i=0,flags=this.curAttr>>18,fg=(this.curAttr>>9)&0x1ff,bg=this.curAttr&0x1ff,p;for(;i<l;i++){p=params[i];if(p>=30&&p<=37){fg=p-30;}else if(p>=40&&p<=47){bg=p-40;}else if(p>=90&&p<=97){p+=8;fg=p-90;}else if(p>=100&&p<=107){p+=8;bg=p-100;}else if(p===0){flags=this.defAttr>>18;fg=(this.defAttr>>9)&0x1ff;bg=this.defAttr&0x1ff;}else if(p===1){flags|=1;}else if(p===4){flags|=2;}else if(p===5){flags|=4;}else if(p===7){flags|=8;}else if(p===8){flags|=16;}else if(p===22){flags&=~1;}else if(p===24){flags&=~2;}else if(p===25){flags&=~4;}else if(p===27){flags&=~8;}else if(p===28){flags&=~16;}else if(p===39){fg=(this.defAttr>>9)&0x1ff;}else if(p===49){bg=this.defAttr&0x1ff;}else if(p===38){if(params[i+1]===2){i+=2;fg=matchColor(params[i]&0xff,params[i+1]&0xff,params[i+2]&0xff);if(fg===-1)fg=0x1ff;i+=2;}else if(params[i+1]===5){i+=2;p=params[i]&0xff;fg=p;}}else if(p===48){if(params[i+1]===2){i+=2;bg=matchColor(params[i]&0xff,params[i+1]&0xff,params[i+2]&0xff);if(bg===-1)bg=0x1ff;i+=2;}else if(params[i+1]===5){i+=2;p=params[i]&0xff;bg=p;}}else if(p===100){fg=(this.defAttr>>9)&0x1ff;bg=this.defAttr&0x1ff;}else{this.error('Unknown SGR attribute: %d.',p);}}
this.curAttr=(flags<<18)|(fg<<9)|bg;};Terminal.prototype.deviceStatus=function(params){if(!this.prefix){switch(params[0]){case 5:this.send('\x1b[0n');break;case 6:this.send('\x1b['
+(this.y+1)
+';'
+(this.x+1)
+'R');break;}}else if(this.prefix==='?'){switch(params[0]){case 6:this.send('\x1b[?'
+(this.y+1)
+';'
+(this.x+1)
+'R');break;case 15:break;case 25:break;case 26:break;case 53:break;}}};Terminal.prototype.insertChars=function(params){var param,row,j,ch;param=params[0];if(param<1)param=1;row=this.y+this.ybase;j=this.x;ch=[this.eraseAttr(),' '];while(param--&&j<this.cols){this.lines[row].splice(j++,0,ch);this.lines[row].pop();}};Terminal.prototype.cursorNextLine=function(params){var param=params[0];if(param<1)param=1;this.y+=param;if(this.y>=this.rows){this.y=this.rows-1;}
this.x=0;};Terminal.prototype.cursorPrecedingLine=function(params){var param=params[0];if(param<1)param=1;this.y-=param;if(this.y<0)this.y=0;this.x=0;};Terminal.prototype.cursorCharAbsolute=function(params){var param=params[0];if(param<1)param=1;this.x=param-1;};Terminal.prototype.insertLines=function(params){var param,row,j;param=params[0];if(param<1)param=1;row=this.y+this.ybase;j=this.rows-1-this.scrollBottom;j=this.rows-1+this.ybase-j+1;while(param--){this.lines.splice(row,0,this.blankLine(true));this.lines.splice(j,1);}
this.updateRange(this.y);this.updateRange(this.scrollBottom);};Terminal.prototype.deleteLines=function(params){var param,row,j;param=params[0];if(param<1)param=1;row=this.y+this.ybase;j=this.rows-1-this.scrollBottom;j=this.rows-1+this.ybase-j;while(param--){this.lines.splice(j+1,0,this.blankLine(true));this.lines.splice(row,1);}
this.updateRange(this.y);this.updateRange(this.scrollBottom);};Terminal.prototype.deleteChars=function(params){var param,row,ch;param=params[0];if(param<1)param=1;row=this.y+this.ybase;ch=[this.eraseAttr(),' '];while(param--){this.lines[row].splice(this.x,1);this.lines[row].push(ch);}};Terminal.prototype.eraseChars=function(params){var param,row,j,ch;param=params[0];if(param<1)param=1;row=this.y+this.ybase;j=this.x;ch=[this.eraseAttr(),' '];while(param--&&j<this.cols){this.lines[row][j++]=ch;}};Terminal.prototype.charPosAbsolute=function(params){var param=params[0];if(param<1)param=1;this.x=param-1;if(this.x>=this.cols){this.x=this.cols-1;}};Terminal.prototype.HPositionRelative=function(params){var param=params[0];if(param<1)param=1;this.x+=param;if(this.x>=this.cols){this.x=this.cols-1;}};Terminal.prototype.sendDeviceAttributes=function(params){if(params[0]>0)return;if(!this.prefix){if(this.is('xterm')||this.is('rxvt-unicode')||this.is('screen')){this.send('\x1b[?1;2c');}else if(this.is('linux')){this.send('\x1b[?6c');}}else if(this.prefix==='>'){if(this.is('xterm')){this.send('\x1b[>0;276;0c');}else if(this.is('rxvt-unicode')){this.send('\x1b[>85;95;0c');}else if(this.is('linux')){this.send(params[0]+'c');}else if(this.is('screen')){this.send('\x1b[>83;40003;0c');}}};Terminal.prototype.linePosAbsolute=function(params){var param=params[0];if(param<1)param=1;this.y=param-1;if(this.y>=this.rows){this.y=this.rows-1;}};Terminal.prototype.VPositionRelative=function(params){var param=params[0];if(param<1)param=1;this.y+=param;if(this.y>=this.rows){this.y=this.rows-1;}};Terminal.prototype.HVPosition=function(params){if(params[0]<1)params[0]=1;if(params[1]<1)params[1]=1;this.y=params[0]-1;if(this.y>=this.rows){this.y=this.rows-1;}
this.x=params[1]-1;if(this.x>=this.cols){this.x=this.cols-1;}};Terminal.prototype.setMode=function(params){if(typeof params==='object'){var l=params.length,i=0;for(;i<l;i++){this.setMode(params[i]);}
return;}
if(!this.prefix){switch(params){case 4:this.insertMode=true;break;case 20:break;}}else if(this.prefix==='?'){switch(params){case 1:this.applicationCursor=true;break;case 2:this.setgCharset(0,Terminal.charsets.US);this.setgCharset(1,Terminal.charsets.US);this.setgCharset(2,Terminal.charsets.US);this.setgCharset(3,Terminal.charsets.US);break;case 3:this.savedCols=this.cols;this.resize(132,this.rows);break;case 6:this.originMode=true;break;case 7:this.wraparoundMode=true;break;case 12:break;case 66:this.log('Serial port requested application keypad.');this.applicationKeypad=true;break;case 9:case 1000:case 1002:case 1003:this.x10Mouse=params===9;this.vt200Mouse=params===1000;this.normalMouse=params>1000;this.mouseEvents=true;this.element.style.cursor='default';this.log('Binding to mouse events.');break;case 1004:this.sendFocus=true;break;case 1005:this.utfMouse=true;break;case 1006:this.sgrMouse=true;break;case 1015:this.urxvtMouse=true;break;case 25:this.cursorHidden=false;break;case 1049:;case 47:case 1047:if(!this.normal){var normal={lines:this.lines,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,tabs:this.tabs};this.reset();this.normal=normal;this.showCursor();}
break;}}};Terminal.prototype.resetMode=function(params){if(typeof params==='object'){var l=params.length,i=0;for(;i<l;i++){this.resetMode(params[i]);}
return;}
if(!this.prefix){switch(params){case 4:this.insertMode=false;break;case 20:break;}}else if(this.prefix==='?'){switch(params){case 1:this.applicationCursor=false;break;case 3:if(this.cols===132&&this.savedCols){this.resize(this.savedCols,this.rows);}
delete this.savedCols;break;case 6:this.originMode=false;break;case 7:this.wraparoundMode=false;break;case 12:break;case 66:this.log('Switching back to normal keypad.');this.applicationKeypad=false;break;case 9:case 1000:case 1002:case 1003:this.x10Mouse=false;this.vt200Mouse=false;this.normalMouse=false;this.mouseEvents=false;this.element.style.cursor='';break;case 1004:this.sendFocus=false;break;case 1005:this.utfMouse=false;break;case 1006:this.sgrMouse=false;break;case 1015:this.urxvtMouse=false;break;case 25:this.cursorHidden=true;break;case 1049:;case 47:case 1047:if(this.normal){this.lines=this.normal.lines;this.ybase=this.normal.ybase;this.ydisp=this.normal.ydisp;this.x=this.normal.x;this.y=this.normal.y;this.scrollTop=this.normal.scrollTop;this.scrollBottom=this.normal.scrollBottom;this.tabs=this.normal.tabs;this.normal=null;this.refresh(0,this.rows-1);this.showCursor();}
break;}}};Terminal.prototype.setScrollRegion=function(params){if(this.prefix)return;this.scrollTop=(params[0]||1)-1;this.scrollBottom=(params[1]||this.rows)-1;this.x=0;this.y=0;};Terminal.prototype.saveCursor=function(params){this.savedX=this.x;this.savedY=this.y;};Terminal.prototype.restoreCursor=function(params){this.x=this.savedX||0;this.y=this.savedY||0;};Terminal.prototype.cursorForwardTab=function(params){var param=params[0]||1;while(param--){this.x=this.nextStop();}};Terminal.prototype.scrollUp=function(params){var param=params[0]||1;while(param--){this.lines.splice(this.ybase+this.scrollTop,1);this.lines.splice(this.ybase+this.scrollBottom,0,this.blankLine());}
this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom);};Terminal.prototype.scrollDown=function(params){var param=params[0]||1;while(param--){this.lines.splice(this.ybase+this.scrollBottom,1);this.lines.splice(this.ybase+this.scrollTop,0,this.blankLine());}
this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom);};Terminal.prototype.initMouseTracking=function(params){};Terminal.prototype.resetTitleModes=function(params){;};Terminal.prototype.cursorBackwardTab=function(params){var param=params[0]||1;while(param--){this.x=this.prevStop();}};Terminal.prototype.repeatPrecedingCharacter=function(params){var param=params[0]||1,line=this.lines[this.ybase+this.y],ch=line[this.x-1]||[this.defAttr,' '];while(param--)line[this.x++]=ch;};Terminal.prototype.tabClear=function(params){var param=params[0];if(param<=0){delete this.tabs[this.x];}else if(param===3){this.tabs={};}};Terminal.prototype.mediaCopy=function(params){;};Terminal.prototype.setResources=function(params){;};Terminal.prototype.disableModifiers=function(params){;};Terminal.prototype.setPointerMode=function(params){;};Terminal.prototype.softReset=function(params){this.cursorHidden=false;this.insertMode=false;this.originMode=false;this.wraparoundMode=false;this.applicationKeypad=false;this.applicationCursor=false;this.scrollTop=0;this.scrollBottom=this.rows-1;this.curAttr=this.defAttr;this.x=this.y=0;this.charset=null;this.glevel=0;this.charsets=[null];};Terminal.prototype.requestAnsiMode=function(params){;};Terminal.prototype.requestPrivateMode=function(params){;};Terminal.prototype.setConformanceLevel=function(params){;};Terminal.prototype.loadLEDs=function(params){;};Terminal.prototype.setCursorStyle=function(params){;};Terminal.prototype.setCharProtectionAttr=function(params){;};Terminal.prototype.restorePrivateValues=function(params){;};Terminal.prototype.setAttrInRectangle=function(params){var t=params[0],l=params[1],b=params[2],r=params[3],attr=params[4];var line,i;for(;t<b+1;t++){line=this.lines[this.ybase+t];for(i=l;i<r;i++){line[i]=[attr,line[i][1]];}}
this.updateRange(params[0]);this.updateRange(params[2]);};Terminal.prototype.savePrivateValues=function(params){;};Terminal.prototype.manipulateWindow=function(params){;};Terminal.prototype.reverseAttrInRectangle=function(params){;};Terminal.prototype.setTitleModeFeature=function(params){;};Terminal.prototype.setWarningBellVolume=function(params){;};Terminal.prototype.setMarginBellVolume=function(params){;};Terminal.prototype.copyRectangle=function(params){;};Terminal.prototype.enableFilterRectangle=function(params){;};Terminal.prototype.requestParameters=function(params){;};Terminal.prototype.selectChangeExtent=function(params){;};Terminal.prototype.fillRectangle=function(params){var ch=params[0],t=params[1],l=params[2],b=params[3],r=params[4];var line,i;for(;t<b+1;t++){line=this.lines[this.ybase+t];for(i=l;i<r;i++){line[i]=[line[i][0],String.fromCharCode(ch)];}}
this.updateRange(params[1]);this.updateRange(params[3]);};Terminal.prototype.enableLocatorReporting=function(params){var val=params[0]>0;};Terminal.prototype.eraseRectangle=function(params){var t=params[0],l=params[1],b=params[2],r=params[3];var line,i,ch;ch=[this.eraseAttr(),' '];for(;t<b+1;t++){line=this.lines[this.ybase+t];for(i=l;i<r;i++){line[i]=ch;}}
this.updateRange(params[0]);this.updateRange(params[2]);};Terminal.prototype.setLocatorEvents=function(params){;};Terminal.prototype.selectiveEraseRectangle=function(params){;};Terminal.prototype.requestLocatorPosition=function(params){;};Terminal.prototype.insertColumns=function(){var param=params[0],l=this.ybase+this.rows,ch=[this.eraseAttr(),' '],i;while(param--){for(i=this.ybase;i<l;i++){this.lines[i].splice(this.x+1,0,ch);this.lines[i].pop();}}
this.maxRange();};Terminal.prototype.deleteColumns=function(){var param=params[0],l=this.ybase+this.rows,ch=[this.eraseAttr(),' '],i;while(param--){for(i=this.ybase;i<l;i++){this.lines[i].splice(this.x,1);this.lines[i].push(ch);}}
this.maxRange();};Terminal.prototype.enterPrefix=function(){this.prefixMode=true;};Terminal.prototype.leavePrefix=function(){this.prefixMode=false;};Terminal.prototype.enterSelect=function(){this._real={x:this.x,y:this.y,ydisp:this.ydisp,ybase:this.ybase,cursorHidden:this.cursorHidden,lines:this.copyBuffer(this.lines),write:this.write};this.write=function(){};this.selectMode=true;this.visualMode=false;this.cursorHidden=false;this.refresh(this.y,this.y);};Terminal.prototype.leaveSelect=function(){this.x=this._real.x;this.y=this._real.y;this.ydisp=this._real.ydisp;this.ybase=this._real.ybase;this.cursorHidden=this._real.cursorHidden;this.lines=this._real.lines;this.write=this._real.write;delete this._real;this.selectMode=false;this.visualMode=false;this.refresh(0,this.rows-1);};Terminal.prototype.enterVisual=function(){this._real.preVisual=this.copyBuffer(this.lines);this.selectText(this.x,this.x,this.ydisp+this.y,this.ydisp+this.y);this.visualMode=true;};Terminal.prototype.leaveVisual=function(){this.lines=this._real.preVisual;delete this._real.preVisual;delete this._selected;this.visualMode=false;this.refresh(0,this.rows-1);};Terminal.prototype.enterSearch=function(down){this.entry='';this.searchMode=true;this.searchDown=down;this._real.preSearch=this.copyBuffer(this.lines);this._real.preSearchX=this.x;this._real.preSearchY=this.y;var bottom=this.ydisp+this.rows-1;for(var i=0;i<this.entryPrefix.length;i++){this.lines[bottom][i]=[(this.defAttr&~0x1ff)|4,this.entryPrefix[i]];}
this.y=this.rows-1;this.x=this.entryPrefix.length;this.refresh(this.rows-1,this.rows-1);};Terminal.prototype.leaveSearch=function(){this.searchMode=false;if(this._real.preSearch){this.lines=this._real.preSearch;this.x=this._real.preSearchX;this.y=this._real.preSearchY;delete this._real.preSearch;delete this._real.preSearchX;delete this._real.preSearchY;}
this.refresh(this.rows-1,this.rows-1);};Terminal.prototype.copyBuffer=function(lines){var lines=lines||this.lines,out=[];for(var y=0;y<lines.length;y++){out[y]=[];for(var x=0;x<lines[y].length;x++){out[y][x]=[lines[y][x][0],lines[y][x][1]];}}
return out;};Terminal.prototype.getCopyTextarea=function(text){var textarea=this._copyTextarea,document=this.document;if(!textarea){textarea=document.createElement('textarea');textarea.style.position='absolute';textarea.style.left='-32000px';textarea.style.top='-32000px';textarea.style.width='0px';textarea.style.height='0px';textarea.style.opacity='0';textarea.style.backgroundColor='transparent';textarea.style.borderStyle='none';textarea.style.outlineStyle='none';document.getElementsByTagName('body')[0].appendChild(textarea);this._copyTextarea=textarea;}
return textarea;};Terminal.prototype.copyText=function(text){var self=this,textarea=this.getCopyTextarea();this.emit('copy',text);textarea.focus();textarea.textContent=text;textarea.value=text;textarea.setSelectionRange(0,text.length);setTimeout(function(){self.element.focus();self.focus();},1);};Terminal.prototype.selectText=function(x1,x2,y1,y2){var ox1,ox2,oy1,oy2,tmp,x,y,xl,attr;if(this._selected){ox1=this._selected.x1;ox2=this._selected.x2;oy1=this._selected.y1;oy2=this._selected.y2;if(oy2<oy1){tmp=ox2;ox2=ox1;ox1=tmp;tmp=oy2;oy2=oy1;oy1=tmp;}
if(ox2<ox1&&oy1===oy2){tmp=ox2;ox2=ox1;ox1=tmp;}
for(y=oy1;y<=oy2;y++){x=0;xl=this.cols-1;if(y===oy1){x=ox1;}
if(y===oy2){xl=ox2;}
for(;x<=xl;x++){if(this.lines[y][x].old!=null){attr=this.lines[y][x].old;delete this.lines[y][x].old;this.lines[y][x]=[attr,this.lines[y][x][1]];}}}
y1=this._selected.y1;x1=this._selected.x1;}
y1=Math.max(y1,0);y1=Math.min(y1,this.ydisp+this.rows-1);y2=Math.max(y2,0);y2=Math.min(y2,this.ydisp+this.rows-1);this._selected={x1:x1,x2:x2,y1:y1,y2:y2};if(y2<y1){tmp=x2;x2=x1;x1=tmp;tmp=y2;y2=y1;y1=tmp;}
if(x2<x1&&y1===y2){tmp=x2;x2=x1;x1=tmp;}
for(y=y1;y<=y2;y++){x=0;xl=this.cols-1;if(y===y1){x=x1;}
if(y===y2){xl=x2;}
for(;x<=xl;x++){attr=this.lines[y][x][0];this.lines[y][x]=[(attr&~0x1ff)|((0x1ff<<9)|4),this.lines[y][x][1]];this.lines[y][x].old=attr;}}
y1=y1-this.ydisp;y2=y2-this.ydisp;y1=Math.max(y1,0);y1=Math.min(y1,this.rows-1);y2=Math.max(y2,0);y2=Math.min(y2,this.rows-1);this.refresh(0,this.rows-1);};Terminal.prototype.grabText=function(x1,x2,y1,y2){var out='',buf='',ch,x,y,xl,tmp;if(y2<y1){tmp=x2;x2=x1;x1=tmp;tmp=y2;y2=y1;y1=tmp;}
if(x2<x1&&y1===y2){tmp=x2;x2=x1;x1=tmp;}
for(y=y1;y<=y2;y++){x=0;xl=this.cols-1;if(y===y1){x=x1;}
if(y===y2){xl=x2;}
for(;x<=xl;x++){ch=this.lines[y][x][1];if(ch===' '){buf+=ch;continue;}
if(buf){out+=buf;buf='';}
out+=ch;if(isWide(ch))x++;}
buf='';out+='\n';}
for(x=x2,y=y2;x<this.cols;x++){if(this.lines[y][x][1]!==' '){out=out.slice(0,-1);break;}}
return out;};Terminal.prototype.keyPrefix=function(ev,key){if(key==='k'||key==='&'){this.destroy();}else if(key==='p'||key===']'){this.emit('request paste');}else if(key==='c'){this.emit('request create');}else if(key>='0'&&key<='9'){key=+key-1;if(!~key)key=9;this.emit('request term',key);}else if(key==='n'){this.emit('request term next');}else if(key==='P'){this.emit('request term previous');}else if(key===':'){this.emit('request command mode');}else if(key==='['){this.enterSelect();}};Terminal.prototype.keySelect=function(ev,key){this.showCursor();if(this.searchMode||key==='n'||key==='N'){return this.keySearch(ev,key);}
if(key==='\x04'){var y=this.ydisp+this.y;if(this.ydisp===this.ybase){this.y=Math.min(this.y+(this.rows-1)/2|0,this.rows-1);this.refresh(0,this.rows-1);}else{this.scrollDisp((this.rows-1)/2|0);}
if(this.visualMode){this.selectText(this.x,this.x,y,this.ydisp+this.y);}
return;}
if(key==='\x15'){var y=this.ydisp+this.y;if(this.ydisp===0){this.y=Math.max(this.y-(this.rows-1)/2|0,0);this.refresh(0,this.rows-1);}else{this.scrollDisp(-(this.rows-1)/2|0);}
if(this.visualMode){this.selectText(this.x,this.x,y,this.ydisp+this.y);}
return;}
if(key==='\x06'){var y=this.ydisp+this.y;this.scrollDisp(this.rows-1);if(this.visualMode){this.selectText(this.x,this.x,y,this.ydisp+this.y);}
return;}
if(key==='\x02'){var y=this.ydisp+this.y;this.scrollDisp(-(this.rows-1));if(this.visualMode){this.selectText(this.x,this.x,y,this.ydisp+this.y);}
return;}
if(key==='k'||key==='\x1b[A'){var y=this.ydisp+this.y;this.y--;if(this.y<0){this.y=0;this.scrollDisp(-1);}
if(this.visualMode){this.selectText(this.x,this.x,y,this.ydisp+this.y);}else{this.refresh(this.y,this.y+1);}
return;}
if(key==='j'||key==='\x1b[B'){var y=this.ydisp+this.y;this.y++;if(this.y>=this.rows){this.y=this.rows-1;this.scrollDisp(1);}
if(this.visualMode){this.selectText(this.x,this.x,y,this.ydisp+this.y);}else{this.refresh(this.y-1,this.y);}
return;}
if(key==='h'||key==='\x1b[D'){var x=this.x;this.x--;if(this.x<0){this.x=0;}
if(this.visualMode){this.selectText(x,this.x,this.ydisp+this.y,this.ydisp+this.y);}else{this.refresh(this.y,this.y);}
return;}
if(key==='l'||key==='\x1b[C'){var x=this.x;this.x++;if(this.x>=this.cols){this.x=this.cols-1;}
if(this.visualMode){this.selectText(x,this.x,this.ydisp+this.y,this.ydisp+this.y);}else{this.refresh(this.y,this.y);}
return;}
if(key==='v'||key===' '){if(!this.visualMode){this.enterVisual();}else{this.leaveVisual();}
return;}
if(key==='y'){if(this.visualMode){var text=this.grabText(this._selected.x1,this._selected.x2,this._selected.y1,this._selected.y2);this.copyText(text);this.leaveVisual();}
return;}
if(key==='q'||key==='\x1b'){if(this.visualMode){this.leaveVisual();}else{this.leaveSelect();}
return;}
if(key==='w'||key==='W'){var ox=this.x;var oy=this.y;var oyd=this.ydisp;var x=this.x;var y=this.y;var yb=this.ydisp;var saw_space=false;for(;;){var line=this.lines[yb+y];while(x<this.cols){if(line[x][1]<=' '){saw_space=true;}else if(saw_space){break;}
x++;}
if(x>=this.cols)x=this.cols-1;if(x===this.cols-1&&line[x][1]<=' '){x=0;if(++y>=this.rows){y--;if(++yb>this.ybase){yb=this.ybase;x=this.x;break;}}
continue;}
break;}
this.x=x,this.y=y;this.scrollDisp(-this.ydisp+yb);if(this.visualMode){this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y);}
return;}
if(key==='b'||key==='B'){var ox=this.x;var oy=this.y;var oyd=this.ydisp;var x=this.x;var y=this.y;var yb=this.ydisp;for(;;){var line=this.lines[yb+y];var saw_space=x>0&&line[x][1]>' '&&line[x-1][1]>' ';while(x>=0){if(line[x][1]<=' '){if(saw_space&&(x+1<this.cols&&line[x+1][1]>' ')){x++;break;}else{saw_space=true;}}
x--;}
if(x<0)x=0;if(x===0&&(line[x][1]<=' '||!saw_space)){x=this.cols-1;if(--y<0){y++;if(--yb<0){yb++;x=0;break;}}
continue;}
break;}
this.x=x,this.y=y;this.scrollDisp(-this.ydisp+yb);if(this.visualMode){this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y);}
return;}
if(key==='e'||key==='E'){var x=this.x+1;var y=this.y;var yb=this.ydisp;if(x>=this.cols)x--;for(;;){var line=this.lines[yb+y];while(x<this.cols){if(line[x][1]<=' '){x++;}else{break;}}
while(x<this.cols){if(line[x][1]<=' '){if(x-1>=0&&line[x-1][1]>' '){x--;break;}}
x++;}
if(x>=this.cols)x=this.cols-1;if(x===this.cols-1&&line[x][1]<=' '){x=0;if(++y>=this.rows){y--;if(++yb>this.ybase){yb=this.ybase;break;}}
continue;}
break;}
this.x=x,this.y=y;this.scrollDisp(-this.ydisp+yb);if(this.visualMode){this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y);}
return;}
if(key==='^'||key==='0'){var ox=this.x;if(key==='0'){this.x=0;}else if(key==='^'){var line=this.lines[this.ydisp+this.y];var x=0;while(x<this.cols){if(line[x][1]>' '){break;}
x++;}
if(x>=this.cols)x=this.cols-1;this.x=x;}
if(this.visualMode){this.selectText(ox,this.x,this.ydisp+this.y,this.ydisp+this.y);}else{this.refresh(this.y,this.y);}
return;}
if(key==='$'){var ox=this.x;var line=this.lines[this.ydisp+this.y];var x=this.cols-1;while(x>=0){if(line[x][1]>' '){if(this.visualMode&&x<this.cols-1)x++;break;}
x--;}
if(x<0)x=0;this.x=x;if(this.visualMode){this.selectText(ox,this.x,this.ydisp+this.y,this.ydisp+this.y);}else{this.refresh(this.y,this.y);}
return;}
if(key==='g'||key==='G'){var ox=this.x;var oy=this.y;var oyd=this.ydisp;if(key==='g'){this.x=0,this.y=0;this.scrollDisp(-this.ydisp);}else if(key==='G'){this.x=0,this.y=this.rows-1;this.scrollDisp(this.ybase);}
if(this.visualMode){this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y);}
return;}
if(key==='H'||key==='M'||key==='L'){var ox=this.x;var oy=this.y;if(key==='H'){this.x=0,this.y=0;}else if(key==='M'){this.x=0,this.y=this.rows/2|0;}else if(key==='L'){this.x=0,this.y=this.rows-1;}
if(this.visualMode){this.selectText(ox,this.x,this.ydisp+oy,this.ydisp+this.y);}else{this.refresh(oy,oy);this.refresh(this.y,this.y);}
return;}
if(key==='{'||key==='}'){var ox=this.x;var oy=this.y;var oyd=this.ydisp;var line;var saw_full=false;var found=false;var first_is_space=-1;var y=this.y+(key==='{'?-1:1);var yb=this.ydisp;var i;if(key==='{'){if(y<0){y++;if(yb>0)yb--;}}else if(key==='}'){if(y>=this.rows){y--;if(yb<this.ybase)yb++;}}
for(;;){line=this.lines[yb+y];for(i=0;i<this.cols;i++){if(line[i][1]>' '){if(first_is_space===-1){first_is_space=0;}
saw_full=true;break;}else if(i===this.cols-1){if(first_is_space===-1){first_is_space=1;}else if(first_is_space===0){found=true;}else if(first_is_space===1){if(saw_full)found=true;}
break;}}
if(found)break;if(key==='{'){y--;if(y<0){y++;if(yb>0)yb--;else break;}}else if(key==='}'){y++;if(y>=this.rows){y--;if(yb<this.ybase)yb++;else break;}}}
if(!found){if(key==='{'){y=0;yb=0;}else if(key==='}'){y=this.rows-1;yb=this.ybase;}}
this.x=0,this.y=y;this.scrollDisp(-this.ydisp+yb);if(this.visualMode){this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y);}
return;}
if(key==='/'||key==='?'){if(!this.visualMode){this.enterSearch(key==='/');}
return;}
return false;};Terminal.prototype.keySearch=function(ev,key){if(key==='\x1b'){this.leaveSearch();return;}
if(key==='\r'||(!this.searchMode&&(key==='n'||key==='N'))){this.leaveSearch();var entry=this.entry;if(!entry){this.refresh(0,this.rows-1);return;}
var ox=this.x;var oy=this.y;var oyd=this.ydisp;var line;var found=false;var wrapped=false;var x=this.x+1;var y=this.ydisp+this.y;var yb,i;var up=key==='N'?this.searchDown:!this.searchDown;for(;;){line=this.lines[y];while(x<this.cols){for(i=0;i<entry.length;i++){if(x+i>=this.cols)break;if(line[x+i][1]!==entry[i]){break;}else if(line[x+i][1]===entry[i]&&i===entry.length-1){found=true;break;}}
if(found)break;x+=i+1;}
if(found)break;x=0;if(!up){y++;if(y>this.ybase+this.rows-1){if(wrapped)break;wrapped=true;y=0;}}else{y--;if(y<0){if(wrapped)break;wrapped=true;y=this.ybase+this.rows-1;}}}
if(found){if(y-this.ybase<0){yb=y;y=0;if(yb>this.ybase){y=yb-this.ybase;yb=this.ybase;}}else{yb=this.ybase;y-=this.ybase;}
this.x=x,this.y=y;this.scrollDisp(-this.ydisp+yb);if(this.visualMode){this.selectText(ox,this.x,oy+oyd,this.ydisp+this.y);}
return;}
this.refresh(0,this.rows-1);return;}
if(key==='\b'||key==='\x7f'){if(this.entry.length===0)return;var bottom=this.ydisp+this.rows-1;this.entry=this.entry.slice(0,-1);var i=this.entryPrefix.length+this.entry.length;this.lines[bottom][i]=[this.lines[bottom][i][0],' '];this.x--;this.refresh(this.rows-1,this.rows-1);this.refresh(this.y,this.y);return;}
if(key.length===1&&key>=' '&&key<='~'){var bottom=this.ydisp+this.rows-1;this.entry+=key;var i=this.entryPrefix.length+this.entry.length-1;this.lines[bottom][i]=[(this.defAttr&~0x1ff)|4,key];this.x++;this.refresh(this.rows-1,this.rows-1);this.refresh(this.y,this.y);return;}
return false;};Terminal.charsets={};Terminal.charsets.SCLD={'`':'\u25c6','a':'\u2592','b':'\u0009','c':'\u000c','d':'\u000d','e':'\u000a','f':'\u00b0','g':'\u00b1','h':'\u2424','i':'\u000b','j':'\u2518','k':'\u2510','l':'\u250c','m':'\u2514','n':'\u253c','o':'\u23ba','p':'\u23bb','q':'\u2500','r':'\u23bc','s':'\u23bd','t':'\u251c','u':'\u2524','v':'\u2534','w':'\u252c','x':'\u2502','y':'\u2264','z':'\u2265','{':'\u03c0','|':'\u2260','}':'\u00a3','~':'\u00b7'};Terminal.charsets.UK=null;Terminal.charsets.US=null;Terminal.charsets.Dutch=null;Terminal.charsets.Finnish=null;Terminal.charsets.French=null;Terminal.charsets.FrenchCanadian=null;Terminal.charsets.German=null;Terminal.charsets.Italian=null;Terminal.charsets.NorwegianDanish=null;Terminal.charsets.Spanish=null;Terminal.charsets.Swedish=null;Terminal.charsets.Swiss=null;Terminal.charsets.ISOLatin=null;function on(el,type,handler,capture){el.addEventListener(type,handler,capture||false);}
function off(el,type,handler,capture){el.removeEventListener(type,handler,capture||false);}
function cancel(ev){if(ev.preventDefault){ev.preventDefault();}
return false;}
function inherits(child,parent){function f(){this.constructor=child;}
f.prototype=parent.prototype;child.prototype=new f;}
function isBoldBroken(document){var body=document.getElementsByTagName('body')[0];var el=document.createElement('span');el.innerHTML='hello world';body.appendChild(el);var w1=el.scrollWidth;el.style.fontWeight='bold';var w2=el.scrollWidth;body.removeChild(el);return w1!==w2;}
var String=this.String;var setTimeout=this.setTimeout;var setInterval=this.setInterval;function indexOf(obj,el){var i=obj.length;while(i--){if(obj[i]===el)return i;}
return-1;}
function isWide(ch){if(ch<='\uff00')return false;return(ch>='\uff01'&&ch<='\uffbe')||(ch>='\uffc2'&&ch<='\uffc7')||(ch>='\uffca'&&ch<='\uffcf')||(ch>='\uffd2'&&ch<='\uffd7')||(ch>='\uffda'&&ch<='\uffdc')||(ch>='\uffe0'&&ch<='\uffe6')||(ch>='\uffe8'&&ch<='\uffee');}
function matchColor(r1,g1,b1){var hash=(r1<<16)|(g1<<8)|b1;if(matchColor._cache[hash]!=null){return matchColor._cache[hash];}
var ldiff=Infinity,li=-1,i=0,c,r2,g2,b2,diff;for(;i<Terminal.vcolors.length;i++){c=Terminal.vcolors[i];r2=c[0];g2=c[1];b2=c[2];diff=matchColor.distance(r1,g1,b1,r2,g2,b2);if(diff===0){li=i;break;}
if(diff<ldiff){ldiff=diff;li=i;}}
return matchColor._cache[hash]=li;}
matchColor._cache={};matchColor.distance=function(r1,g1,b1,r2,g2,b2){return Math.pow(30*(r1-r2),2)
+Math.pow(59*(g1-g2),2)
+Math.pow(11*(b1-b2),2);};function each(obj,iter,con){if(obj.forEach)return obj.forEach(iter,con);for(var i=0;i<obj.length;i++){iter.call(con,obj[i],i,obj);}}
function keys(obj){if(Object.keys)return Object.keys(obj);var key,keys=[];for(key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){keys.push(key);}}
return keys;}
Terminal.EventEmitter=EventEmitter;Terminal.inherits=inherits;Terminal.on=on;Terminal.off=off;Terminal.cancel=cancel;if(typeof module!=='undefined'){module.exports=Terminal;}else{this.Terminal=Terminal;}}).call(function(){return this||(typeof window!=='undefined'?window:global);}());var CryptoJS=CryptoJS||function(o,q){var l={},m=l.lib={},n=m.Base=function(){function a(){}return{extend:function(e){a.prototype=this;var c=new a;e&&c.mixIn(e);c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.$super.extend(this)}}}(),j=m.WordArray=n.extend({init:function(a,e){a=this.words=a||[];this.sigBytes=e!=q?e:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var e=this.words,c=a.words,d=this.sigBytes,a=a.sigBytes;this.clamp();if(d%4)for(var b=0;b<a;b++)e[d+b>>>2]|=(c[b>>>2]>>>24-8*(b%4)&255)<<24-8*((d+b)%4);else if(65535<c.length)for(b=0;b<a;b+=4)e[d+b>>>2]=c[b>>>2];else e.push.apply(e,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,e=this.sigBytes;a[e>>>2]&=4294967295<<32-8*(e%4);a.length=o.ceil(e/4)},clone:function(){var a=n.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var e=[],c=0;c<a;c+=4)e.push(4294967296*o.random()|0);return j.create(e,a)}}),k=l.enc={},r=k.Hex={stringify:function(a){for(var e=a.words,a=a.sigBytes,c=[],d=0;d<a;d++){var b=e[d>>>2]>>>24-8*(d%4)&255;c.push((b>>>4).toString(16));c.push((b&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return j.create(c,b/2)}},p=k.Latin1={stringify:function(a){for(var b=a.words,a=a.sigBytes,c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return j.create(c,b)}},h=k.Utf8={stringify:function(a){try{return decodeURIComponent(escape(p.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return p.parse(unescape(encodeURIComponent(a)))}},b=m.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=j.create();this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=h.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,d=b.sigBytes,f=this.blockSize,i=d/(4*f),i=a?o.ceil(i):o.max((i|0)-this._minBufferSize,0),a=i*f,d=o.min(4*a,d);if(a){for(var h=0;h<a;h+=f)this._doProcessBlock(c,h);h=c.splice(0,a);b.sigBytes-=d}return j.create(h,d)},clone:function(){var a=n.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});m.Hasher=b.extend({init:function(){this.reset()},reset:function(){b.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);this._doFinalize();return this._hash},clone:function(){var a=b.clone.call(this);a._hash=this._hash.clone();return a},blockSize:16,_createHelper:function(a){return function(b,c){return a.create(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return f.HMAC.create(a,c).finalize(b)}}});var f=l.algo={};return l}(Math);(function(o){function q(b,f,a,e,c,d,g){b=b+(f&a|~f&e)+c+g;return(b<<d|b>>>32-d)+f}function l(b,f,a,e,c,d,g){b=b+(f&e|a&~e)+c+g;return(b<<d|b>>>32-d)+f}function m(b,f,a,e,c,d,g){b=b+(f^a^e)+c+g;return(b<<d|b>>>32-d)+f}function n(b,f,a,e,c,d,g){b=b+(a^(f|~e))+c+g;return(b<<d|b>>>32-d)+f}var j=CryptoJS,k=j.lib,r=k.WordArray,k=k.Hasher,p=j.algo,h=[];(function(){for(var b=0;64>b;b++)h[b]=4294967296*o.abs(o.sin(b+1))|0})();p=p.MD5=k.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(b,f){for(var a=0;16>a;a++){var e=f+a,c=b[e];b[e]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}for(var e=this._hash.words,c=e[0],d=e[1],g=e[2],i=e[3],a=0;64>a;a+=4)16>a?(c=q(c,d,g,i,b[f+a],7,h[a]),i=q(i,c,d,g,b[f+a+1],12,h[a+1]),g=q(g,i,c,d,b[f+a+2],17,h[a+2]),d=q(d,g,i,c,b[f+a+3],22,h[a+3])):32>a?(c=l(c,d,g,i,b[f+(a+1)%16],5,h[a]),i=l(i,c,d,g,b[f+(a+6)%16],9,h[a+1]),g=l(g,i,c,d,b[f+(a+11)%16],14,h[a+2]),d=l(d,g,i,c,b[f+a%16],20,h[a+3])):48>a?(c=m(c,d,g,i,b[f+(3*a+5)%16],4,h[a]),i=m(i,c,d,g,b[f+(3*a+8)%16],11,h[a+1]),g=m(g,i,c,d,b[f+(3*a+11)%16],16,h[a+2]),d=m(d,g,i,c,b[f+(3*a+14)%16],23,h[a+3])):(c=n(c,d,g,i,b[f+3*a%16],6,h[a]),i=n(i,c,d,g,b[f+(3*a+7)%16],10,h[a+1]),g=n(g,i,c,d,b[f+(3*a+14)%16],15,h[a+2]),d=n(d,g,i,c,b[f+(3*a+5)%16],21,h[a+3]));e[0]=e[0]+c|0;e[1]=e[1]+d|0;e[2]=e[2]+g|0;e[3]=e[3]+i|0},_doFinalize:function(){var b=this._data,f=b.words,a=8*this._nDataBytes,e=8*b.sigBytes;f[e>>>5]|=128<<24-e%32;f[(e+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;b.sigBytes=4*(f.length+1);this._process();b=this._hash.words;for(f=0;4>f;f++)a=b[f],b[f]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360}});j.MD5=k._createHelper(p);j.HmacMD5=k._createHmacHelper(p)})(Math);(function(){if("function"==typeof ArrayBuffer){var b=CryptoJS.lib.WordArray,e=b.init;(b.init=function(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));if(a instanceof Int8Array||a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);if(a instanceof Uint8Array){for(var b=a.byteLength,d=[],c=0;c<b;c++)d[c>>>2]|=a[c]<<24-8*(c%4);e.call(this,d,b)}else e.apply(this,arguments)}).prototype=b}})();